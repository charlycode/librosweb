<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="es" xml:lang="es">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta http-equiv="content-type" content="text/html; charset=utf-8" />
        <title>12.8. Configuración de la página list (El tutorial Jobeet)</title>
        <link href="../../css/main-fa23fb7.css" rel="stylesheet" type="text/css" />
        <script type="text/javascript">
            var _gaq = _gaq || [];
            _gaq.push(['_setAccount', 'UA-82842-2']);
            _gaq.push(['_trackPageview']);

            (function() {
                var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
                ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
                var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
            })();
        </script>
        <link rel="apple-touch-icon" type="image/png" href="../../apple-touch-icon.png" />
        <link rel="apple-touch-icon-precomposed" type="image/png" href="../../apple-touch-icon.png" />
        <meta name="apple-mobile-web-app-title" content="LibrosWeb" />

        <link rel="shortcut icon" type="image/png" href="../../favicon.png" />
        <meta name="site:version" content="fa23fb7" />
        <link rel="author" href="https://plus.google.com/u/0/107307901774377088868" />
        <link rel="prev" href="configuracion_de_los_campos.html" />
        <link rel="next" href="configuracion_de_la_pagina_de_formularios.html" />
        <link rel="start" href="../index.html" />
        <meta name="twitter:site" content="@librosweb" />
        <link rel="search" type="application/opensearchdescription+xml" href="http://librosweb.es/opensearch/documentation.xml" title="Libros y tutoriales de LibrosWeb.es" />
        <meta property="fb:page_id" content="437758756273955" />
        <meta property="fb:app_id" content="437758756273955" />
        <meta property="og:type" content="website" />
        <meta property="og:title" content="12.8. Configuración de la página list (El tutorial Jobeet)" />
        <meta property="og:image" content="http://www.gravatar.com/avatar/9f219b4dfaa677bfd0f47753c02d5126.png?s=200" />
        <meta name="msapplication-TileColor" content="#CC1414" />
        <meta name="application-name" content="LibrosWeb" />
        <meta name="msapplication-tooltip" content="Libros y tutoriales sobre HTML, CSS, JavaScript, PHP y otras tecnologías web." />
    </head>
    <body class="book_page jobeet_1_4">
    <div id="container" class="container">
        <div id="header">
            <h1><a href="../../index.html" title="LibrosWeb.es">LibrosWeb</a></h1>
            <form action="/buscar"><input type="text" placeholder="buscar..." name="q"/></form>
        </div>
        <div id="content"><div class="row">
        <ul class="breadcrumbs span12">
  <li><a href="../../index.html">Inicio</a></li>
  <li><a href="../index.html">El tutorial Jobeet</a></li>
  <li><a href="../capitulo_12.html">Capítulo 12. El generador de la parte de administración</a></li>
  <li class="current"><span>12.8.. Configuración de la página list</span></li>
</ul>

<div class="span9">
    <h1 id="configuracion_de_la_pagina_list"><span>12.8.</span> Configuración de la página list</h1>
    

<h3 id="la_opcion_display">12.9.1. La opción display</h3>

<p>La página del listado muestra por defecto todas las columnas del modelo, en el mismo orden en el que se indicaron en el archivo del esquema. La opción <code>display</code> establece las columnas que se muestran y el orden en el que lo hacen:</p>

<div class="code yaml">
<pre class="yaml"><span class="co1"># apps/backend/modules/category/config/generator.yml</span><span class="co4">
config</span>:<span class="co4">
  list</span>:<span class="co3">
    title</span><span class="sy2">: </span>  Category Management<span class="co3">
    display</span><span class="sy2">: </span><span class="br0">&#91;</span>=name, slug<span class="br0">&#93;</span></pre>
</div>

<p>El símbolo <code>=</code> delante de la columna <code>name</code> es una convención que indica que se debe convertir la cadena de texto en un enlace.</p>

<div class="figure" id="figure_12_4">
    <img src="../../img/jobeet_1_4/f1203.png" alt="La tabla del listado" />

    <p class="caption"><strong>Figura 12.4</strong> La tabla del listado</p>
</div>


<p>A continuación se realiza la misma configuración en el módulo <code>job</code> para hacerlo más fácil de leer:</p>

<div class="code yaml">
<pre class="yaml"><span class="co1"># apps/backend/modules/job/config/generator.yml</span><span class="co4">
config</span>:<span class="co4">
  list</span>:<span class="co3">
    title</span><span class="sy2">: </span>  Job Management<span class="co3">
    display</span><span class="sy2">: </span><span class="br0">&#91;</span>company, position, location, url, is_activated, email<span class="br0">&#93;</span></pre>
</div>

<h3 id="la_opcion_layout">12.8.2. La opción layout</h3>

<p>Los listados se pueden mostrar con diferentes layouts. El layout por defecto es <code>tabular</code>, que muestra el valor de cada columna en su propia columna de la tabla. No obstante, en el módulo <code>job</code> sería mejor utilizar el layout <code>stacked</code>, que es el otro layout que incluye Symfony:</p>

<div class="code yaml">
<pre class="yaml"><span class="co1"># apps/backend/modules/job/config/generator.yml</span><span class="co4">
config</span>:<span class="co4">
  list</span>:<span class="co3">
    title</span><span class="sy2">: </span>  Job Management<span class="co3">
    layout</span><span class="sy2">: </span> stacked<span class="co3">
    display</span><span class="sy2">: </span><span class="br0">&#91;</span>company, position, location, url, is_activated, email<span class="br0">&#93;</span><span class="co3">
    params</span><span class="sy2">: </span> <span class="sy2">|
</span><span class="co0">      %%is_activated%% &lt;small&gt;%%category_id%%&lt;/small&gt; - %%company%%
       (&lt;em&gt;%%email%%&lt;/em&gt;) is looking for a %%=position%% (%%location%%)</span></pre>
</div>

<p>En el layout <code>stacked</code>, cada objeto se representa en una sola cadena de texto, cuyo formato se define en la opción <code>params</code>.</p>

<div class="admonition note"><p><strong class="title">Nota</strong> En el ejemplo anterior, la opción <code>display</code> sigue siendo necesaria porque define las columnas por las que el usuario puede reordenar los resultados.</p></div>

<h3 id="columnas_virtuales">12.9.2. Columnas virtuales</h3>

<p>Si se utiliza la configuración anterior, el fragmento <code>%%category_id%%</code> se reemplaza por el valor de la clave primaria de la categoría. Sin embargo, en este caso sería más útil mostrar el nombre de la categoría.</p>

<p>Cuando se hace uso de la notación <code>%%</code>, la variable indicada no tiene que ser obligatoriamente una columna real de la base de datos. Para mostrar el valor de una variable, lo único que necesita el generador de la parte de administración es un método <em>getter</em> en la clase del modelo.</p>

<p>Si queremos mostrar el nombre de una categoría, podemos crear un método llamado <code>getCategoryName()</code> en la clase <code>JobeetJob</code> y reemplazar el fragmento <code>%%category_id%%</code> por <code>%%category_name%%</code>.</p>

<p>Por otra parte, la clase <code>JobeetJob</code> ya dispone de un método llamado <code>getJobeetCategory()</code> y que devuelve el objeto de la categoría relacionada. Por tanto, si utilizas <code>%%jobeet_category%%</code>, ya se va a mostrar el nombre de la categoría, ya que la clase <code>JobeetCategory</code> incluye un método mágico <code>__toString()</code> que convierte un objeto en una cadena de texto.</p>

<div class="code yaml">
<pre class="yaml"><span class="co1"># apps/backend/modules/job/config/generator.yml</span>
<span class="co2">%%is_activated%% &lt;small&gt;%%jobeet_category%%&lt;/small&gt; - %%company%% </span>
 <span class="br0">&#40;</span>&lt;em&gt;<span class="co2">%%email%%&lt;/em&gt;) is looking for a %%=position%% (%%location%%)</span></pre>
</div>

<div class="figure" id="figure_12_5">
    <img src="../../img/jobeet_1_4/f1204.png" alt="El layout stacked" />

    <p class="caption"><strong>Figura 12.5</strong> El layout stacked</p>
</div>


<h3 id="la_opcion_sort">12.8.4. La opción sort</h3>

<p>Si eres un administrador, seguramente querrás ver las últimas ofertas de trabajo publicadas. Para configurar la columna por la que se ordenan los datos por defecto, incluye la opción <code>sort</code> indicando el nombre de la columna y el tipo de ordenación:</p>

<div class="code yaml">
<pre class="yaml"><span class="co1"># apps/backend/modules/job/config/generator.yml</span><span class="co4">
config</span>:<span class="co4">
  list</span>:<span class="co3">
    sort</span><span class="sy2">: </span><span class="br0">&#91;</span>expires_at, desc<span class="br0">&#93;</span></pre>
</div>

<h3 id="la_opcion_max_per_page">12.8.5. La opción max_per_page</h3>

<p>El listado incluye por defecto una paginación que muestra 20 elementos en cada página. Este valor se puede modificar con la opción <code>max_per_page</code>:</p>

<div class="code yaml">
<pre class="yaml"><span class="co1"># apps/backend/modules/job/config/generator.yml</span><span class="co4">
config</span>:<span class="co4">
  list</span>:<span class="co3">
    max_per_page</span><span class="sy2">: </span><span class="nu0">10</span></pre>
</div>

<div class="figure" id="figure_12_6">
    <img src="../../img/jobeet_1_4/f1205.png" alt="Modificando el máximo número de elementos por página" />

    <p class="caption"><strong>Figura 12.6</strong> Modificando el máximo número de elementos por página</p>
</div>


<h3 id="la_opcion_batch_actions">12.8.6. La opción batch_actions</h3>

<p>En un listado se puede ejecutar una misma acción sobre varios objetos a la vez. Estas acciones por lotes no se necesitan en el módulo <code>category</code>, por lo que podemos eliminarlas:</p>

<div class="code yaml">
<pre class="yaml"><span class="co1"># apps/backend/modules/category/config/generator.yml</span><span class="co4">
config</span>:<span class="co4">
  list</span>:<span class="co3">
    batch_actions</span><span class="sy2">: </span><span class="br0">&#123;</span><span class="br0">&#125;</span></pre>
</div>

<div class="figure" id="figure_12_7">
    <img src="../../img/jobeet_1_4/f1206.png" alt="Eliminando las acciones por lotes" />

    <p class="caption"><strong>Figura 12.7</strong> Eliminando las acciones por lotes</p>
</div>


<p>La opción <code>batch_actions</code> define la lista de acciones que se pueden realizar por lotes. Para eliminar esta opción, simplemente se indica un array vacío.</p>

<p>Por defecto cada módulo dispone de una acción de borrado por lotes llamada <code>delete</code> y que define el propio framework. Vamos a suponer que para el módulo <code>job</code> necesitamos además una acción por lotes que permita extender la validez de varias ofertas de trabajo por otros 30 días:</p>

<div class="code yaml">
<pre class="yaml"><span class="co1"># apps/backend/modules/job/config/generator.yml</span><span class="co4">
config</span>:<span class="co4">
  list</span>:<span class="co4">
    batch_actions</span>:<span class="co3">
      _delete</span><span class="sy2">: </span>   ~<span class="co3">
      extend</span><span class="sy2">: </span>    ~</pre>
</div>

<p>Las acciones cuyo nombre comienza por <code>_</code> son acciones que incluye el propio framework. Si refrescas la página en el navegador y seleccionas la acción <em>Extend</em>, Symfony lanza una excepción que indica que debes crear un método llamado <code>executeBatchExtend()</code>:</p>

<div class="code php">
<pre class="php"><span class="co1">// apps/backend/modules/job/actions/actions.class.php</span>
<span class="kw2">class</span> jobActions <span class="kw2">extends</span> autoJobActions
<span class="br0">&#123;</span>
  <span class="kw2">public</span> <span class="kw2">function</span> executeBatchExtend<span class="br0">&#40;</span>sfWebRequest <span class="re0">$request</span><span class="br0">&#41;</span>
  <span class="br0">&#123;</span>
    <span class="re0">$ids</span> <span class="sy0">=</span> <span class="re0">$request</span><span class="sy0">-&gt;</span><span class="me1">getParameter</span><span class="br0">&#40;</span><span class="st_h">'ids'</span><span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp;
    <span class="re0">$jobs</span> <span class="sy0">=</span> JobeetJobPeer<span class="sy0">::</span><span class="me2">retrieveByPks</span><span class="br0">&#40;</span><span class="re0">$ids</span><span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp;
    <span class="kw1">foreach</span> <span class="br0">&#40;</span><span class="re0">$jobs</span> <span class="kw1">as</span> <span class="re0">$job</span><span class="br0">&#41;</span>
    <span class="br0">&#123;</span>
      <span class="re0">$job</span><span class="sy0">-&gt;</span><span class="me1">extend</span><span class="br0">&#40;</span><span class="kw4">true</span><span class="br0">&#41;</span><span class="sy0">;</span>
    <span class="br0">&#125;</span>
&nbsp;
    <span class="re0">$this</span><span class="sy0">-&gt;</span><span class="me1">getUser</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">-&gt;</span><span class="me1">setFlash</span><span class="br0">&#40;</span><span class="st_h">'notice'</span><span class="sy0">,</span> <span class="st_h">'The selected jobs have been extended successfully.'</span><span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp;
    <span class="re0">$this</span><span class="sy0">-&gt;</span><span class="me1">redirect</span><span class="br0">&#40;</span><span class="st_h">'@jobeet_job'</span><span class="br0">&#41;</span><span class="sy0">;</span>
  <span class="br0">&#125;</span>
<span class="br0">&#125;</span></pre>
</div>

<p>Las claves primarias de los elementos seleccionados se almacenan en el parámetro <code>ids</code> de la petición. Una vez obtenidas las claves primarias, se ejecuta para cada oferta de trabajo seleccionada el método <code>JobeetJob::extend()</code> con un argumento adicional que permite saltarse la comprobación de la fecha de expiración que realiza ese método.</p>

<p>Actualiza el método <code>extend()</code> pra que tenga en cuenta este nuevo parámetro:</p>

<div class="code php">
<pre class="php"><span class="co1">// lib/model/JobeetJob.php</span>
<span class="kw2">class</span> JobeetJob <span class="kw2">extends</span> BaseJobeetJob
<span class="br0">&#123;</span>
  <span class="kw2">public</span> <span class="kw2">function</span> extend<span class="br0">&#40;</span><span class="re0">$force</span> <span class="sy0">=</span> <span class="kw4">false</span><span class="br0">&#41;</span>
  <span class="br0">&#123;</span>
    <span class="kw1">if</span> <span class="br0">&#40;</span><span class="sy0">!</span><span class="re0">$force</span> <span class="sy0">&amp;&amp;</span> <span class="sy0">!</span><span class="re0">$this</span><span class="sy0">-&gt;</span><span class="me1">expiresSoon</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="br0">&#41;</span>
    <span class="br0">&#123;</span>
      <span class="kw1">return</span> <span class="kw4">false</span><span class="sy0">;</span>
    <span class="br0">&#125;</span>
&nbsp;
    <span class="re0">$this</span><span class="sy0">-&gt;</span><span class="me1">setExpiresAt</span><span class="br0">&#40;</span><span class="kw3">time</span><span class="br0">&#40;</span><span class="br0">&#41;</span> <span class="sy0">+</span> <span class="nu0">86400</span> <span class="sy0">*</span> sfConfig<span class="sy0">::</span><span class="me2">get</span><span class="br0">&#40;</span><span class="st_h">'app_active_days'</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="sy0">;</span>
    <span class="re0">$this</span><span class="sy0">-&gt;</span><span class="me1">save</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp;
    <span class="kw1">return</span> <span class="kw4">true</span><span class="sy0">;</span>
  <span class="br0">&#125;</span>
&nbsp;
  <span class="co1">// ...</span>
<span class="br0">&#125;</span></pre>
</div>

<p>Una vez aumentada la validez de todas las ofertas de trabajo, se redirige al usuario a la portada del módulo <code>job</code>:</p>

<div class="figure" id="figure_12_8">
    <img src="../../img/jobeet_1_4/f1207.png" alt="Acciones por lotes propias" />

    <p class="caption"><strong>Figura 12.8</strong> Acciones por lotes propias</p>
</div>


<h3 id="la_opcion_object_actions">12.8.7. La opción object_actions</h3>

<p>En el listado de elementos siempre se muestra una columna adicional que contiene las acciones que se pueden realizar sobre un objeto individual. En el módulo <code>category</code> no necesitamos estas acciones porque ya disponemos del nombre de la categoría que es un enlace a la página de modificación de datos y porque tampoco necesitamos borrar una categoría directamente desde el listado:</p>

<div class="code yaml">
<pre class="yaml"><span class="co1"># apps/backend/modules/category/config/generator.yml</span><span class="co4">
config</span>:<span class="co4">
  list</span>:<span class="co3">
    object_actions</span><span class="sy2">: </span><span class="br0">&#123;</span><span class="br0">&#125;</span></pre>
</div>

<p>En el módulo <code>job</code> vamos a dejar todas las acciones existentes y vamos a añadir una nueva acción llamada <code>extend</code> que es similar a la que acabamos de crear como acción por lotes:</p>

<div class="code yaml">
<pre class="yaml"><span class="co1"># apps/backend/modules/job/config/generator.yml</span><span class="co4">
config</span>:<span class="co4">
  list</span>:<span class="co4">
    object_actions</span>:<span class="co3">
      extend</span><span class="sy2">: </span>    ~<span class="co3">
      _edit</span><span class="sy2">: </span>     ~<span class="co3">
      _delete</span><span class="sy2">: </span>   ~</pre>
</div>

<p>Como sucede para las acciones por lotes, las acciones <code>_delete</code> y <code>_edit</code> son acciones que define el propio framework, ya que su nombre empieza por <code>_</code>. Para que la acción <code>extend</code> se pueda utilizar, debemos definir la acción <code>listExtend()</code>:</p>

<div class="code php">
<pre class="php"><span class="co1">// apps/backend/modules/job/actions/actions.class.php</span>
<span class="kw2">class</span> jobActions <span class="kw2">extends</span> autoJobActions
<span class="br0">&#123;</span>
  <span class="kw2">public</span> <span class="kw2">function</span> executeListExtend<span class="br0">&#40;</span>sfWebRequest <span class="re0">$request</span><span class="br0">&#41;</span>
  <span class="br0">&#123;</span>
    <span class="re0">$job</span> <span class="sy0">=</span> <span class="re0">$this</span><span class="sy0">-&gt;</span><span class="me1">getRoute</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">-&gt;</span><span class="me1">getObject</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
    <span class="re0">$job</span><span class="sy0">-&gt;</span><span class="me1">extend</span><span class="br0">&#40;</span><span class="kw4">true</span><span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp;
    <span class="re0">$this</span><span class="sy0">-&gt;</span><span class="me1">getUser</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">-&gt;</span><span class="me1">setFlash</span><span class="br0">&#40;</span><span class="st_h">'notice'</span><span class="sy0">,</span> <span class="st_h">'The selected jobs have been extended successfully.'</span><span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp;
    <span class="re0">$this</span><span class="sy0">-&gt;</span><span class="me1">redirect</span><span class="br0">&#40;</span><span class="st_h">'@jobeet_job'</span><span class="br0">&#41;</span><span class="sy0">;</span>
  <span class="br0">&#125;</span>
&nbsp;
  <span class="co1">// ...</span>
<span class="br0">&#125;</span></pre>
</div>

<div class="figure" id="figure_12_9">
    <img src="../../img/jobeet_1_4/f1208.png" alt="Creando una acción propia para los objetos" />

    <p class="caption"><strong>Figura 12.9</strong> Creando una acción propia para los objetos</p>
</div>


<h3 id="la_opcion_actions">12.8.8. La opción actions</h3>

<p>En las secciones anteriores se ha mostrado cómo añadir acciones por lotes y acciones que afectan a un solo objeto. Por su parte, la opción <code>actions</code> define las acciones que no utilizan ningún objeto, como la acción para crear un nuevo objeto. A continuación vamos a eliminar la opción <code>new</code> incluida por defecto y vamos a añadir una acción que borre todas las ofertas de trabajo que llevan más de 60 días sin ser activadas por parte del usuario que las insertó:</p>

<div class="code yaml">
<pre class="yaml"><span class="co1"># apps/backend/modules/job/config/generator.yml</span><span class="co4">
config</span>:<span class="co4">
  list</span>:<span class="co4">
    actions</span>:<span class="co3">
      deleteNeverActivated</span><span class="sy2">: </span><span class="br0">&#123;</span> label<span class="sy2">: </span>Delete never activated jobs <span class="br0">&#125;</span></pre>
</div>

<p>Hasta ahora, todas las acciones las hemos definido mediante <code>~</code>, lo que significa que Symfony configura automáticamente esas acciones. Cada acción se puede personalizar pasándole un array de parámetros. La opción <code>label</code> redefine la etiqueta generada por defecto por Symfony.</p>

<p>Por defecto, la acción que se ejecuta cuando pinchas el enlace es el nombre de la acción prefijado con <code>list</code>.</p>

<p>Crea la acción <code>listDeleteNeverActivated</code> en el módulo <code>job</code>:</p>

<div class="code php">
<pre class="php"><span class="co1">// apps/backend/modules/job/actions/actions.class.php</span>
<span class="kw2">class</span> jobActions <span class="kw2">extends</span> autoJobActions
<span class="br0">&#123;</span>
  <span class="kw2">public</span> <span class="kw2">function</span> executeListDeleteNeverActivated<span class="br0">&#40;</span>sfWebRequest <span class="re0">$request</span><span class="br0">&#41;</span>
  <span class="br0">&#123;</span>
    <span class="re0">$nb</span> <span class="sy0">=</span> JobeetJobPeer<span class="sy0">::</span><span class="me2">cleanup</span><span class="br0">&#40;</span><span class="nu0">60</span><span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp;
    <span class="kw1">if</span> <span class="br0">&#40;</span><span class="re0">$nb</span><span class="br0">&#41;</span>
    <span class="br0">&#123;</span>
      <span class="re0">$this</span><span class="sy0">-&gt;</span><span class="me1">getUser</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">-&gt;</span><span class="me1">setFlash</span><span class="br0">&#40;</span><span class="st_h">'notice'</span><span class="sy0">,</span> <span class="kw3">sprintf</span><span class="br0">&#40;</span><span class="st_h">'%d never activated jobs have been deleted successfully.'</span><span class="sy0">,</span> <span class="re0">$nb</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="sy0">;</span>
    <span class="br0">&#125;</span>
    <span class="kw1">else</span>
    <span class="br0">&#123;</span>
      <span class="re0">$this</span><span class="sy0">-&gt;</span><span class="me1">getUser</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">-&gt;</span><span class="me1">setFlash</span><span class="br0">&#40;</span><span class="st_h">'notice'</span><span class="sy0">,</span> <span class="st_h">'No job to delete.'</span><span class="br0">&#41;</span><span class="sy0">;</span>
    <span class="br0">&#125;</span>
&nbsp;
    <span class="re0">$this</span><span class="sy0">-&gt;</span><span class="me1">redirect</span><span class="br0">&#40;</span><span class="st_h">'@jobeet_job'</span><span class="br0">&#41;</span><span class="sy0">;</span>
  <span class="br0">&#125;</span>
&nbsp;
  <span class="co1">// ...</span>
<span class="br0">&#125;</span></pre>
</div>

<p>Como ya te habrás dado cuenta, hemos reutilizado el método <code>JobeetJobPeer::cleanup()</code> que definimos ayer. Este es otro ejemplo de las posibilidades de reutilización de código que nos brinda el patrón de diseño MVC.</p>

<div class="admonition note"><p><strong class="title">Nota</strong> También puedes modificar la acción que se ejecuta mediante el parámetro <code>action</code>:</p>

<div class="code yaml">
<pre class="yaml"><span class="co3">deleteNeverActivated</span><span class="sy2">: </span><span class="br0">&#123;</span> label<span class="sy2">: </span>Delete never activated jobs, action<span class="sy2">: </span>foo <span class="br0">&#125;</span></pre>
</div>

<p></p></div>

<div class="figure" id="figure_12_10">
    <img src="../../img/jobeet_1_4/f1209.png" alt="Acciones propias" />

    <p class="caption"><strong>Figura 12.10</strong> Acciones propias</p>
</div>


<h3 id="la_opcion_peer_method">12.8.9. La opción peer_method</h3>

<p>Como muestra la barra de depuración web, se necesitan 14 consultas a la base de datos para mostrar el listado de ofertas de trabajo:</p>

<p>Si pinchas sobre ese número, verás que la mayoría de consultas se utilizan para obtener el nombre de la categoría de cada oferta de trabajo:</p>

<div class="figure" id="figure_12_11">
    <img src="../../img/jobeet_1_4/f1210.png" alt="Número inicial de consultas" />

    <p class="caption"><strong>Figura 12.11</strong> Número inicial de consultas</p>
</div>


<p>Si quieres reducir el número de consultas, en la opción <code>peer_method</code> puedes modificar el método por defecto que se emplea para obtener las ofertas de trabajo:</p>

<div class="code yaml">
<pre class="yaml"><span class="co1"># apps/backend/modules/job/config/generator.yml</span><span class="co4">
config</span>:<span class="co4">
  list</span>:<span class="co3">
    peer_method</span><span class="sy2">: </span>doSelectJoinJobeetCategory</pre>
</div>

<p>El método <code>doSelectJoinJobeetCategory()</code> añade un <code>JOIN</code> entre las tablas <code>job</code> y <code>category</code> para crear de forma automática el objeto de tipo categoría relacionado con cada oferta de trabajo.</p>

<p>Ahora el número de consultas se ha reducido a sólo cuatro:</p>

<div class="figure" id="figure_12_12">
    <img src="../../img/jobeet_1_4/f1211.png" alt="Número final de consultas" />

    <p class="caption"><strong>Figura 12.12</strong> Número final de consultas</p>
</div>




    <div class="navigation row">
            <a class="span4 prev" href="configuracion_de_los_campos.html">&larr; Anterior <span>12.7. Configuración de los campos</span></a>
            
            <a class="span5 next" href="configuracion_de_la_pagina_de_formularios.html">Siguiente &rarr; <span>12.9. Configuración de la página de formularios</span></a>
        </div>
</div>

<div class="span3 side">
<h3 class="underline"><span>Compartir</span></h3>
<ul class="share">
    <li><a class="twitter" id="share_twitter" href="#" title="Compartir este artículo en Twitter">tw</a></li>
    <li><a class="facebook" id="share_facebook" href="#" title="Compartir este artículo en Facebook">fb</a></li>
    <li><a class="google" id="share_google" href="#" title="Compartir este artículo en Google+">g+</a></li>
</ul>

<script type="text/javascript">
var title    = 'Configuración de la página list (El tutorial Jobeet%29';
var page_url = encodeURIComponent(window.location);
var options  = 'menubar=no,toolbar=no,resizable=yes,scrollbars=no,width=640,height=350';
var services = {
    share_twitter:  'https://twitter.com/share?text=' + title + '&lang=es&hashtags=librosweb',
    share_facebook: 'http://www.facebook.com/sharer.php?u=' + page_url + '&t=' + title,
    share_google:   'https://plus.google.com/share?url=' + page_url + '&hl=es'
};

for (var id in services) { // don't use services.keys() for compatibility reasons
    if (services.hasOwnProperty(id)) {
        document.getElementById(id).href = services[id];
        document.getElementById(id).onclick = function(a) {
            a = a || window.event;
            a = a.target || a.srcElement;
            _gaq.push(['_trackEvent', 'share', a.id.substr(6), 'El tutorial Jobeet : Configuración de la página list']);
            window.open(services[a.id], a.title, options);

            return false;
        };
    }
}
</script>

<h3 class="underline"><span>Indice de contenidos</span></h3>
<ul class="toc">
    <li class="level-1">
        <span>1</span> <a href="../capitulo_1.html"> Comenzando el proyecto</a>
    </li>
    <li class="level-1">
        <span>2</span> <a href="../capitulo_2.html"> El proyecto</a>
    </li>
    <li class="level-1">
        <span>3</span> <a href="../capitulo_3.html"> El modelo de datos</a>
    </li>
    <li class="level-1">
        <span>4</span> <a href="../capitulo_4.html"> El controlador y la vista</a>
    </li>
    <li class="level-1">
        <span>5</span> <a href="../capitulo_5.html"> El sistema de enrutamiento</a>
    </li>
    <li class="level-1">
        <span>6</span> <a href="../capitulo_6.html"> Profundizando en el modelo</a>
    </li>
    <li class="level-1">
        <span>7</span> <a href="../capitulo_7.html"> Trabajando con la página de cada categoría</a>
    </li>
    <li class="level-1">
        <span>8</span> <a href="../capitulo_8.html"> Pruebas unitarias</a>
    </li>
    <li class="level-1">
        <span>9</span> <a href="../capitulo_9.html"> Pruebas funcionales</a>
    </li>
    <li class="level-1">
        <span>10</span> <a href="../capitulo_10.html"> Los formularios</a>
    </li>
    <li class="level-1">
        <span>11</span> <a href="../capitulo_11.html"> Probando los formularios</a>
    </li>
    <li class="level-1 ">
        <a href="../capitulo_12.html">
            <span>Capítulo 12.</span> El generador de la parte de administración
        </a>
    </li>
    <li class="level-2 ">
        <a href="creando_la_aplicacion_backend.html">
            <span>12.1.</span> Creando la aplicación backend
        </a>
    </li>
    <li class="level-2 ">
        <a href="los_modulos_de_la_aplicacion_backend.html">
            <span>12.2.</span> Los módulos de la aplicación backend
        </a>
    </li>
    <li class="level-2 ">
        <a href="el_aspecto_de_la_aplicacion_backend.html">
            <span>12.3.</span> El aspecto de la aplicación backend
        </a>
    </li>
    <li class="level-2 ">
        <a href="la_cache_de_symfony.html">
            <span>12.4.</span> La cache de Symfony
        </a>
    </li>
    <li class="level-2 ">
        <a href="la_configuracion_de_la_aplicacion_backend.html">
            <span>12.5.</span> La configuración de la aplicación backend
        </a>
    </li>
    <li class="level-2 ">
        <a href="configuracion_del_titulo.html">
            <span>12.6.</span> Configuración del título
        </a>
    </li>
    <li class="level-2 ">
        <a href="configuracion_de_los_campos.html">
            <span>12.7.</span> Configuración de los campos
        </a>
    </li>
    <li class="level-2 active">
        <a href="configuracion_de_la_pagina_list.html">
            <span>12.8.</span> Configuración de la página list
        </a>
    </li>
    <li class="level-2 ">
        <a href="configuracion_de_la_pagina_de_formularios.html">
            <span>12.9.</span> Configuración de la página de formularios
        </a>
    </li>
    <li class="level-2 ">
        <a href="configuracion_de_los_filtros.html">
            <span>12.10.</span> Configuración de los filtros
        </a>
    </li>
    <li class="level-2 ">
        <a href="modificando_las_acciones.html">
            <span>12.11.</span> Modificando las acciones
        </a>
    </li>
    <li class="level-2 ">
        <a href="personalizando_las_plantillas.html">
            <span>12.12.</span> Personalizando las plantillas
        </a>
    </li>
    <li class="level-2 ">
        <a href="configuracion_final.html">
            <span>12.13.</span> Configuración final
        </a>
    </li>
    <li class="level-2 ">
        <a href="nos_vemos_manana.html">
            <span>12.14.</span> Nos vemos mañana
        </a>
    </li>
    <li class="level-1">
        <span>13</span> <a href="../capitulo_13.html"> El usuario</a>
    </li>
    <li class="level-1">
        <span>14</span> <a href="../capitulo_14.html"> El día de descanso</a>
    </li>
    <li class="level-1">
        <span>15</span> <a href="../capitulo_15.html"> Canales Atom</a>
    </li>
    <li class="level-1">
        <span>16</span> <a href="../capitulo_16.html"> Servicios web</a>
    </li>
    <li class="level-1">
        <span>17</span> <a href="../capitulo_17.html"> El buscador</a>
    </li>
    <li class="level-1">
        <span>18</span> <a href="../capitulo_18.html"> AJAX</a>
    </li>
    <li class="level-1">
        <span>19</span> <a href="../capitulo_19.html"> Internacionalización y localización</a>
    </li>
    <li class="level-1">
        <span>20</span> <a href="../capitulo_20.html"> Plugins</a>
    </li>
    <li class="level-1">
        <span>21</span> <a href="../capitulo_21.html"> El día del diseño</a>
    </li>
    <li class="level-1">
        <span>22</span> <a href="../capitulo_22.html"> La cache</a>
    </li>
    <li class="level-1">
        <span>23</span> <a href="../capitulo_23.html"> Pasando a producción</a>
    </li>
    <li class="level-1">
        <span>24</span> <a href="../capitulo_24.html"> Un repaso a Symfony</a>
    </li>
</ul>
</div>
        </div></div>
        <div id="footer" class="row">
            <span class="span6">&copy; 2013 LibrosWeb.es 
            <a href="../../contacto/index.html">Contacto</a></span>
            <span class="span6 version">2.340 días online</span>
        </div>
    </div>
    </body>
</html>

<!-- Localized -->