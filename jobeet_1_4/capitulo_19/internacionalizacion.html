<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="es" xml:lang="es">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta http-equiv="content-type" content="text/html; charset=utf-8" />
        <title>19.5. Internacionalización (El tutorial Jobeet)</title>
        <link href="../../css/main-fa23fb7.css" rel="stylesheet" type="text/css" />
        <script type="text/javascript">
            var _gaq = _gaq || [];
            _gaq.push(['_setAccount', 'UA-82842-2']);
            _gaq.push(['_trackPageview']);

            (function() {
                var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
                ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
                var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
            })();
        </script>
        <link rel="apple-touch-icon" type="image/png" href="../../apple-touch-icon.png" />
        <link rel="apple-touch-icon-precomposed" type="image/png" href="../../apple-touch-icon.png" />
        <meta name="apple-mobile-web-app-title" content="LibrosWeb" />

        <link rel="shortcut icon" type="image/png" href="../../favicon.png" />
        <meta name="site:version" content="fa23fb7" />
        <link rel="author" href="https://plus.google.com/u/0/107307901774377088868" />
        <link rel="prev" href="cambiando_de_idioma.html" />
        <link rel="next" href="localizacion.html" />
        <link rel="start" href="../index.html" />
        <meta name="twitter:site" content="@librosweb" />
        <link rel="search" type="application/opensearchdescription+xml" href="http://librosweb.es/opensearch/documentation.xml" title="Libros y tutoriales de LibrosWeb.es" />
        <meta property="fb:page_id" content="437758756273955" />
        <meta property="fb:app_id" content="437758756273955" />
        <meta property="og:type" content="website" />
        <meta property="og:title" content="19.5. Internacionalización (El tutorial Jobeet)" />
        <meta property="og:image" content="http://www.gravatar.com/avatar/9f219b4dfaa677bfd0f47753c02d5126.png?s=200" />
        <meta name="msapplication-TileColor" content="#CC1414" />
        <meta name="application-name" content="LibrosWeb" />
        <meta name="msapplication-tooltip" content="Libros y tutoriales sobre HTML, CSS, JavaScript, PHP y otras tecnologías web." />
    </head>
    <body class="book_page jobeet_1_4">
    <div id="container" class="container">
        <div id="header">
            <h1><a href="../../index.html" title="LibrosWeb.es">LibrosWeb</a></h1>
            <form action="/buscar"><input type="text" placeholder="buscar..." name="q"/></form>
        </div>
        <div id="content"><div class="row">
        <ul class="breadcrumbs span12">
  <li><a href="../../index.html">Inicio</a></li>
  <li><a href="../index.html">El tutorial Jobeet</a></li>
  <li><a href="../capitulo_19.html">Capítulo 19. Internacionalización y localización</a></li>
  <li class="current"><span>19.5.. Internacionalización</span></li>
</ul>

<div class="span9">
    <h1 id="internacionalizacion"><span>19.5.</span> Internacionalización</h1>
    

<h3 id="idiomas_codificaciones_y_conjuntos_de_caracteres">19.5.1. Idiomas, codificaciones y conjuntos de caracteres</h3>

<p>Cada idioma define su propio conjunto de caracteres. El idioma inglés es el más sencillo porque sólo utiliza los caracteres ASCII. Otros idiomas como el francés son más complicados porque utilizan por ejemplo caracteres acentuados como <code>é</code>. Por último, idiomas como el ruso, el chino o el árabe son mucho más complicados porque todos sus caracteres se encuentran fuera del conjunto de caracteres ASCII. Estos últimos idiomas definen conjuntos de caracteres completamente diferentes.</p>

<p>Cuando se trabaja con aplicaciones internacionalizadas, es mejor seguir la norma <em>unicode</em>. La idea del estándar unicode consiste en crear un conjunto universal de caracteres que incluya todos los caracteres de todos los idiomas de la humanidad. El problema de unicode es que, debido a este enorme conjunto de caracteres, cada carácter puede llegar a necesitar hasta 21 bits para ser representado. Por tanto, para las aplicaciones web utilizamos UTF-8, que transforma los caracteres de Unicode en secuencias de octetos de longitud variable. Empleando UTF-8, los caracteres de los idiomas más utilizados en el mundo se representan con menos de 3 bits cada uno.</p>

<p>UTF-8 es la codificación que utiliza por defecto Symfony, tal y como se establece en el archivo de configuración <code>settings.yml</code>:</p>

<div class="code yaml">
<pre class="yaml"><span class="co1"># apps/frontend/config/settings.yml</span><span class="co4">
all</span>:<span class="co4">
  .settings</span>:<span class="co3">
    charset</span><span class="sy2">: </span>utf-<span class="nu0">8</span></pre>
</div>

<p>Además, para activar la internacionalización en Symfony, debes establecer la opción <code>i18n</code> a un valor <code>on</code> en el archivo de configuración <code>settings.yml</code>:</p>

<div class="code yaml">
<pre class="yaml"><span class="co1"># apps/frontend/config/settings.yml</span><span class="co4">
all</span>:<span class="co4">
  .settings</span>:<span class="co3">
    i18n</span><span class="sy2">: </span>on</pre>
</div>

<h3 id="plantillas">19.6.1. Plantillas</h3>

<p>Un sitio web internacionalizado es aquel cuya interfaz de usuario se traduce a varios idiomas.</p>

<p>En las plantillas, las cadenas de texto que dependen del idioma utilizado se deben encerrar con el helper <code>__()</code> (cuidado al escribir el helper porque son dos guiones bajos seguidos).</p>

<p>El helper <code>__()</code> es parte del grupo de helpers <code>I18N</code>, que contiene helpers que facilitan el trabajo con la internacionalización de las plantillas. Como este grupo de helpers no se carga por defecto, debes incluirlo manualmente en la plantilla mediante <code>use_helper('I18N')</code> (como ya hicimos en su día para el grupo de helpers <code>Text</code>) o puedes cargarlo de forma global en la aplicación utilizando la opción <code>standard_helpers</code>:</p>

<div class="code yaml">
<pre class="yaml"><span class="co1"># apps/frontend/config/settings.yml</span><span class="co4">
all</span>:<span class="co4">
  .settings</span>:<span class="co3">
    standard_helpers</span><span class="sy2">: </span><span class="br0">&#91;</span>Partial, Cache, I18N<span class="br0">&#93;</span></pre>
</div>

<p>El siguiente código muestra cómo utilizar el helper <code>__()</code> en el pie de página de Jobeet:</p>

<div class="code php">
<pre class="php">// apps/frontend/templates/layout.php
&lt;div id=&quot;footer&quot;&gt;
  &lt;div class=&quot;content&quot;&gt;
    &lt;span class=&quot;symfony&quot;&gt;
      &lt;img src=&quot;/images/jobeet-mini.png&quot; /&gt;
      powered by &lt;a href=&quot;http://www.symfony-project.org/&quot;&gt;
      &lt;img src=&quot;/images/symfony.gif&quot; alt=&quot;symfony framework&quot; /&gt;&lt;/a&gt;
    &lt;/span&gt;
    &lt;ul&gt;
      &lt;li&gt;
        &lt;a href=&quot;&quot;&gt;<span class="kw2">&lt;?php</span> <span class="kw1">echo</span> __<span class="br0">&#40;</span><span class="st_h">'About Jobeet'</span><span class="br0">&#41;</span> <span class="sy1">?&gt;</span>&lt;/a&gt;
      &lt;/li&gt;
      &lt;li class=&quot;feed&quot;&gt;
        <span class="kw2">&lt;?php</span> <span class="kw1">echo</span> link_to<span class="br0">&#40;</span>__<span class="br0">&#40;</span><span class="st_h">'Full feed'</span><span class="br0">&#41;</span><span class="sy0">,</span> <span class="st_h">'@job?sf_format=atom'</span><span class="br0">&#41;</span> <span class="sy1">?&gt;</span>
      &lt;/li&gt;
      &lt;li&gt;
        &lt;a href=&quot;&quot;&gt;<span class="kw2">&lt;?php</span> <span class="kw1">echo</span> __<span class="br0">&#40;</span><span class="st_h">'Jobeet API'</span><span class="br0">&#41;</span> <span class="sy1">?&gt;</span>&lt;/a&gt;
      &lt;/li&gt;
      &lt;li class=&quot;last&quot;&gt;
        <span class="kw2">&lt;?php</span> <span class="kw1">echo</span> link_to<span class="br0">&#40;</span>__<span class="br0">&#40;</span><span class="st_h">'Become an affiliate'</span><span class="br0">&#41;</span><span class="sy0">,</span> <span class="st_h">'@affiliate_new'</span><span class="br0">&#41;</span> <span class="sy1">?&gt;</span>
      &lt;/li&gt;
    &lt;/ul&gt;
    <span class="kw2">&lt;?php</span> include_component<span class="br0">&#40;</span><span class="st_h">'language'</span><span class="sy0">,</span> <span class="st_h">'language'</span><span class="br0">&#41;</span> <span class="sy1">?&gt;</span>
  &lt;/div&gt;
&lt;/div&gt;</pre>
</div>

<div class="admonition note"><p><strong class="title">Nota</strong> Al helper <code>__()</code> se le puede pasar como argumento la cadena de texto mostrada para el idioma por defecto o también se le puede pasar el identificador único de cada cadena. Elegir una u otra opción es simplemente una cuestión de gusto personal. En Jobeet vamos a utilizar la primera forma porque así las plantillas son mucho más fáciles de leer.</p></div>

<p>Cuando Symfony procesa la plantilla para mostrarla, cada vez que encuentra una llamada al helper <code>__()</code>, Symfony busca la traducción de la cadena de texto para la cultura actual del usuario. Si se encuentra la traducción, se muestra directamente en la plantilla. Si no se encuentra la traducción, se devuelve el primer argumento del helper <code>__()</code>.</p>

<p>Las traducciones se guardan en catálogos. El framework de internacionalización de Symfony incluye muchas formas de guardar las traducciones. En este caso vamos a utilizar <a href="http://es.wikipedia.org/wiki/XLIFF">el formato XLIFF</a>, que es un estándar internacional y también es el más flexible. Además, XLIFF es el formato utilizado por el generador de la parte de administración y por la mayoría de plugins de Symfony.</p>

<div class="admonition note"><p><strong class="title">Nota</strong> Las otras formas de guardar los catálogos son <code>gettext</code>, <code>MySQL</code> y <code>SQLite</code>. Como siempre, no te olvides de echar un vistazo a <a href="http://www.symfony-project.org/api/1_2/i18n">la API de i18n</a> para descubrir todos los detalles.</p></div>

<h3 id="la_tarea_i18nextract">19.5.3. La tarea i18n:extract</h3>

<p>Si no quieres crear el catálogo a mano, puedes utilizar la tarea <code>i18n:extract</code>:</p>

<div class="code cli">
<pre class="cli">$ php symfony i18n:extract frontend fr --auto-save</pre>
</div>

<p>La tarea <code>i18n:extract</code> del ejemplo anterior busca todas las cadenas de texto que deben traducirse al idioma <code>fr</code> en la aplicación <code>frontend</code> y crea o actualiza el catálogo correspondiente. La opción <code>--auto-save</code> hace que se guarden en el catálogo las nuevas cadenas de texto. También puedes hacer uso de la opción <code>--auto-delete</code> para eliminar automáticamente todas las cadenas de texto que ya no existen.</p>

<p>En nuestro caso, la tarea anterior añade todas las cadenas de texto al archivo que hemos creado:</p>

<div class="code xml">
<pre class="xml"><span class="sc-1">&lt;!-- apps/frontend/i18n/fr/messages.xml --&gt;</span>
<span class="sc3"><span class="re1">&lt;?xml</span> <span class="re0">version</span>=<span class="st0">&quot;1.0&quot;</span> <span class="re0">encoding</span>=<span class="st0">&quot;UTF-8&quot;</span><span class="re2">?&gt;</span></span>
<span class="sc0">&lt;!DOCTYPE xliff PUBLIC &quot; *XLIFF*DTD XLIFF//EN&quot;</span>
<span class="sc0">  &quot;http://www.oasis-open.org/committees/xliff/documents/xliff.dtd&quot;&gt;</span>
<span class="sc3"><span class="re1">&lt;xliff</span> <span class="re0">version</span>=<span class="st0">&quot;1.0&quot;</span><span class="re2">&gt;</span></span>
  <span class="sc3"><span class="re1">&lt;file</span> <span class="re0">source-language</span>=<span class="st0">&quot;EN&quot;</span> <span class="re0">target-language</span>=<span class="st0">&quot;fr&quot;</span> <span class="re0">datatype</span>=<span class="st0">&quot;plaintext&quot;</span></span>
<span class="sc3">      <span class="re0">original</span>=<span class="st0">&quot;messages&quot;</span> <span class="re0">date</span>=<span class="st0">&quot;2008-12-14T12:11:22Z&quot;</span></span>
<span class="sc3">      <span class="re0">product-name</span>=<span class="st0">&quot;messages&quot;</span><span class="re2">&gt;</span></span>
    <span class="sc3"><span class="re1">&lt;header</span><span class="re2">/&gt;</span></span>
    <span class="sc3"><span class="re1">&lt;body<span class="re2">&gt;</span></span></span>
      <span class="sc3"><span class="re1">&lt;trans-unit</span> <span class="re0">id</span>=<span class="st0">&quot;1&quot;</span><span class="re2">&gt;</span></span>
        <span class="sc3"><span class="re1">&lt;source<span class="re2">&gt;</span></span></span>About Jobeet<span class="sc3"><span class="re1">&lt;/source<span class="re2">&gt;</span></span></span>
        <span class="sc3"><span class="re1">&lt;target</span><span class="re2">/&gt;</span></span>
      <span class="sc3"><span class="re1">&lt;/trans-unit<span class="re2">&gt;</span></span></span>
      <span class="sc3"><span class="re1">&lt;trans-unit</span> <span class="re0">id</span>=<span class="st0">&quot;2&quot;</span><span class="re2">&gt;</span></span>
        <span class="sc3"><span class="re1">&lt;source<span class="re2">&gt;</span></span></span>Feed<span class="sc3"><span class="re1">&lt;/source<span class="re2">&gt;</span></span></span>
        <span class="sc3"><span class="re1">&lt;target</span><span class="re2">/&gt;</span></span>
      <span class="sc3"><span class="re1">&lt;/trans-unit<span class="re2">&gt;</span></span></span>
      <span class="sc3"><span class="re1">&lt;trans-unit</span> <span class="re0">id</span>=<span class="st0">&quot;3&quot;</span><span class="re2">&gt;</span></span>
        <span class="sc3"><span class="re1">&lt;source<span class="re2">&gt;</span></span></span>Jobeet API<span class="sc3"><span class="re1">&lt;/source<span class="re2">&gt;</span></span></span>
        <span class="sc3"><span class="re1">&lt;target</span><span class="re2">/&gt;</span></span>
      <span class="sc3"><span class="re1">&lt;/trans-unit<span class="re2">&gt;</span></span></span>
      <span class="sc3"><span class="re1">&lt;trans-unit</span> <span class="re0">id</span>=<span class="st0">&quot;4&quot;</span><span class="re2">&gt;</span></span>
        <span class="sc3"><span class="re1">&lt;source<span class="re2">&gt;</span></span></span>Become an affiliate<span class="sc3"><span class="re1">&lt;/source<span class="re2">&gt;</span></span></span>
        <span class="sc3"><span class="re1">&lt;target</span><span class="re2">/&gt;</span></span>
      <span class="sc3"><span class="re1">&lt;/trans-unit<span class="re2">&gt;</span></span></span>
    <span class="sc3"><span class="re1">&lt;/body<span class="re2">&gt;</span></span></span>
  <span class="sc3"><span class="re1">&lt;/file<span class="re2">&gt;</span></span></span>
<span class="sc3"><span class="re1">&lt;/xliff<span class="re2">&gt;</span></span></span></pre>
</div>

<p>Cada traducción se define mediante una etiqueta <code>trans-unit</code> que tiene un identificador único en forma de atributo <code>id</code>. Ahora ya puedes modificar ese archivo para añadir las traducciones al francés:</p>

<div class="code xml">
<pre class="xml"><span class="sc-1">&lt;!-- apps/frontend/i18n/fr/messages.xml --&gt;</span>
<span class="sc3"><span class="re1">&lt;?xml</span> <span class="re0">version</span>=<span class="st0">&quot;1.0&quot;</span> <span class="re0">encoding</span>=<span class="st0">&quot;UTF-8&quot;</span><span class="re2">?&gt;</span></span>
<span class="sc0">&lt;!DOCTYPE xliff PUBLIC &quot; *XLIFF*DTD XLIFF//EN&quot;</span>
<span class="sc0">  &quot;http://www.oasis-open.org/committees/xliff/documents/xliff.dtd&quot;&gt;</span>
<span class="sc3"><span class="re1">&lt;xliff</span> <span class="re0">version</span>=<span class="st0">&quot;1.0&quot;</span><span class="re2">&gt;</span></span>
  <span class="sc3"><span class="re1">&lt;file</span> <span class="re0">source-language</span>=<span class="st0">&quot;EN&quot;</span> <span class="re0">target-language</span>=<span class="st0">&quot;fr&quot;</span> <span class="re0">datatype</span>=<span class="st0">&quot;plaintext&quot;</span></span>
<span class="sc3">      <span class="re0">original</span>=<span class="st0">&quot;messages&quot;</span> <span class="re0">date</span>=<span class="st0">&quot;2008-12-14T12:11:22Z&quot;</span></span>
<span class="sc3">      <span class="re0">product-name</span>=<span class="st0">&quot;messages&quot;</span><span class="re2">&gt;</span></span>
    <span class="sc3"><span class="re1">&lt;header</span><span class="re2">/&gt;</span></span>
    <span class="sc3"><span class="re1">&lt;body<span class="re2">&gt;</span></span></span>
      <span class="sc3"><span class="re1">&lt;trans-unit</span> <span class="re0">id</span>=<span class="st0">&quot;1&quot;</span><span class="re2">&gt;</span></span>
        <span class="sc3"><span class="re1">&lt;source<span class="re2">&gt;</span></span></span>About Jobeet<span class="sc3"><span class="re1">&lt;/source<span class="re2">&gt;</span></span></span>
        <span class="sc3"><span class="re1">&lt;target<span class="re2">&gt;</span></span></span>A propos de Jobeet<span class="sc3"><span class="re1">&lt;/target<span class="re2">&gt;</span></span></span>
      <span class="sc3"><span class="re1">&lt;/trans-unit<span class="re2">&gt;</span></span></span>
      <span class="sc3"><span class="re1">&lt;trans-unit</span> <span class="re0">id</span>=<span class="st0">&quot;2&quot;</span><span class="re2">&gt;</span></span>
        <span class="sc3"><span class="re1">&lt;source<span class="re2">&gt;</span></span></span>Feed<span class="sc3"><span class="re1">&lt;/source<span class="re2">&gt;</span></span></span>
        <span class="sc3"><span class="re1">&lt;target<span class="re2">&gt;</span></span></span>Fil RSS<span class="sc3"><span class="re1">&lt;/target<span class="re2">&gt;</span></span></span>
      <span class="sc3"><span class="re1">&lt;/trans-unit<span class="re2">&gt;</span></span></span>
      <span class="sc3"><span class="re1">&lt;trans-unit</span> <span class="re0">id</span>=<span class="st0">&quot;3&quot;</span><span class="re2">&gt;</span></span>
        <span class="sc3"><span class="re1">&lt;source<span class="re2">&gt;</span></span></span>Jobeet API<span class="sc3"><span class="re1">&lt;/source<span class="re2">&gt;</span></span></span>
        <span class="sc3"><span class="re1">&lt;target<span class="re2">&gt;</span></span></span>API Jobeet<span class="sc3"><span class="re1">&lt;/target<span class="re2">&gt;</span></span></span>
      <span class="sc3"><span class="re1">&lt;/trans-unit<span class="re2">&gt;</span></span></span>
      <span class="sc3"><span class="re1">&lt;trans-unit</span> <span class="re0">id</span>=<span class="st0">&quot;4&quot;</span><span class="re2">&gt;</span></span>
        <span class="sc3"><span class="re1">&lt;source<span class="re2">&gt;</span></span></span>Become an affiliate<span class="sc3"><span class="re1">&lt;/source<span class="re2">&gt;</span></span></span>
        <span class="sc3"><span class="re1">&lt;target<span class="re2">&gt;</span></span></span>Devenir un affilié<span class="sc3"><span class="re1">&lt;/target<span class="re2">&gt;</span></span></span>
      <span class="sc3"><span class="re1">&lt;/trans-unit<span class="re2">&gt;</span></span></span>
    <span class="sc3"><span class="re1">&lt;/body<span class="re2">&gt;</span></span></span>
  <span class="sc3"><span class="re1">&lt;/file<span class="re2">&gt;</span></span></span>
<span class="sc3"><span class="re1">&lt;/xliff<span class="re2">&gt;</span></span></span></pre>
</div>

<div class="admonition note"><p><strong class="title">Nota</strong> Como XLIFF es un formato estándar, existen muchas herramientas que facilitan el proceso de traducción. <a href="https://open-language-tools.dev.java.net/">Open Language Tools</a> es un proyecto de software libre creado con Java que incluye un editor de archivos en formato XLIFF.</p></div>

<div class="admonition note"><p><strong class="title">Nota</strong> Como XLIFF es un formato basado en archivos de texto, se le aplican las mismas reglas de la configuración en cascada que se utiliza para los archivos de configuración de Symfony. Se pueden definir archivos i18n a nivel de proyecto, aplicación y módulo, aplicándose siempre la traducción del archivo más específico.</p></div>

<h3 id="traducciones_con_variables">19.5.4. Traducciones con variables</h3>

<p>El principal objetivo de la internacionalización consiste en traducir frases enteras. No obstante, algunas frases incluyen partes variables. En Jobeet, este caso se produce con los enlaces <em>"and X more..."</em> de la portada, donde <code>X</code> es el número de ofertas de trabajo disponibles:</p>

<div class="code php">
<pre class="php">&lt;!-- apps/frontend/modules/job/templates/indexSuccess.php --&gt;
&lt;div class=&quot;more_jobs&quot;&gt;
  and <span class="kw2">&lt;?php</span> <span class="kw1">echo</span> link_to<span class="br0">&#40;</span><span class="re0">$count</span><span class="sy0">,</span> <span class="st_h">'category'</span><span class="sy0">,</span> <span class="re0">$category</span><span class="br0">&#41;</span> <span class="sy1">?&gt;</span> more...
&lt;/div&gt;</pre>
</div>

<p>Como el número de ofertas de trabajo es variable, en la traducción tenemos que sustituirlo por una variable:</p>

<div class="code php">
<pre class="php">&lt;!-- apps/frontend/modules/job/templates/indexSuccess.php --&gt;
&lt;div class=&quot;more_jobs&quot;&gt;
  <span class="kw2">&lt;?php</span> <span class="kw1">echo</span> __<span class="br0">&#40;</span><span class="st_h">'and %count% more...'</span><span class="sy0">,</span> <span class="kw3">array</span><span class="br0">&#40;</span><span class="st_h">'%count%'</span> <span class="sy0">=&gt;</span> link_to<span class="br0">&#40;</span><span class="re0">$count</span><span class="sy0">,</span> <span class="st_h">'category'</span><span class="sy0">,</span> <span class="re0">$category</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="br0">&#41;</span> <span class="sy1">?&gt;</span>
&lt;/div&gt;</pre>
</div>

<p>Ahora la cadena de texto que tenemos que traducir es <code>and %count% more...</code>, siendo <code>%count%</code> la variable que se va a sustituir por el número de ofertas de trabajo indicado como segundo argumento del helper <code>__()</code>.</p>

<p>Añade la nueva cadena de texto en una etiqueta <code>trans-unit</code> del archivo <code>messages.xml</code>, o utiliza la tarea <code>i18n:extract</code> para actualizar el archivo automáticamente:</p>

<div class="code cli">
<pre class="cli">$ php symfony i18n:extract frontend fr --auto-save</pre>
</div>

<p>Después de ejecutar la tarea, abre el archivo XLIFF y añade la correspondiente traducción al francés:</p>

<div class="code xml">
<pre class="xml"><span class="sc3"><span class="re1">&lt;trans-unit</span> <span class="re0">id</span>=<span class="st0">&quot;5&quot;</span><span class="re2">&gt;</span></span>
  <span class="sc3"><span class="re1">&lt;source<span class="re2">&gt;</span></span></span>and %count% more...<span class="sc3"><span class="re1">&lt;/source<span class="re2">&gt;</span></span></span>
  <span class="sc3"><span class="re1">&lt;target<span class="re2">&gt;</span></span></span>et %count% autres...<span class="sc3"><span class="re1">&lt;/target<span class="re2">&gt;</span></span></span>
<span class="sc3"><span class="re1">&lt;/trans-unit<span class="re2">&gt;</span></span></span></pre>
</div>

<p>El único requisito de la traduccón es que debes utilizar en algún sitio la variable <code>%count%</code>.</p>

<p>Traducir otras cadenas de texto puede llegar a ser muy complicado por el uso de los plurales. Estas cadenas de texto cambian en función del valor de algunos números. Además, el comportamiento de los plurales no es idéntico en todos los idiomas, ya que idiomas como el ruso o el polaco tienen reglas gramaticales muy complejas para los plurales.</p>

<p>En la página de cada categoría, se muestra el número de ofertas de trabajo disponibles para esa categoría:</p>

<div class="code php">
<pre class="php">&lt;!-- apps/frontend/modules/category/templates/showSuccess.php --&gt;
&lt;strong&gt;<span class="kw2">&lt;?php</span> <span class="kw1">echo</span> <span class="re0">$pager</span><span class="sy0">-&gt;</span><span class="me1">getNbResults</span><span class="br0">&#40;</span><span class="br0">&#41;</span> <span class="sy1">?&gt;</span>&lt;/strong&gt; jobs in this category</pre>
</div>

<p>Cuando la traducción de una cadena de texto es diferente en función del valor de un número, debes utilizar el helper <code>format_number_choice()</code>:</p>

<div class="code php">
<pre class="php"><span class="kw2">&lt;?php</span> <span class="kw1">echo</span> format_number_choice<span class="br0">&#40;</span>
    <span class="st_h">'[0]No job in this category|[1]One job in this category|(1,+Inf]%count% jobs in this category'</span><span class="sy0">,</span>
    <span class="kw3">array</span><span class="br0">&#40;</span><span class="st_h">'%count%'</span> <span class="sy0">=&gt;</span> <span class="st_h">'&lt;strong&gt;'</span><span class="sy0">.</span><span class="re0">$pager</span><span class="sy0">-&gt;</span><span class="me1">getNbResults</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">.</span><span class="st_h">'&lt;/strong&gt;'</span><span class="br0">&#41;</span><span class="sy0">,</span>
    <span class="re0">$pager</span><span class="sy0">-&gt;</span><span class="me1">getNbResults</span><span class="br0">&#40;</span><span class="br0">&#41;</span>
  <span class="br0">&#41;</span>
<span class="sy1">?&gt;</span></pre>
</div>

<p>El helper <code>format_number_choice()</code> requiere tres argumentos:</p>

<ul>
<li>La cadena de texto que se utiliza en función del número</li>
<li>Un array con las sustituciones de la parte variable</li>
<li>El número empleado para determinar la traducción que se utiliza</li>
</ul>

<p>La cadena que establece las diferentes traducciones a utilizar en función del valor del número emplea el siguiente formato:</p>

<ul>
<li>Cada posible traducción se separa de las demás mediante una barra vertical (<code>|</code>)</li>
<li>Cada cadena de texto está formada por un rango seguido de una traducción</li>
</ul>

<p>El rango puede describir cualquier tipo de rango numérico:</p>

<ul>
<li><code>[1,2]</code>:     acepta todos los valores entre <code>1</code> y <code>2</code>, incluyendo <code>1</code> y <code>2</code></li>
<li><code>(1,2)</code>:     acepta todos los valores entre <code>1</code> y <code>2</code>, salvo <code>1</code> y <code>2</code></li>
<li><code>{1,2,3,4}</code>: sólo acepta los números indicados en ese conjunto de valores</li>
<li><code>[-Inf,0)</code>:  acepta valores mayores o iguales que -infinito y estrictamente inferiores a <code>0</code></li>
<li><code>{n: n % 10 &gt; 1 &amp;&amp; n % 10 &lt; 5}</code>: acepta números como <code>2</code>, <code>3</code>, <code>4</code>, <code>22</code>, <code>23</code>, <code>24</code>, etc.</li>
</ul>

<p>Traducir esta cadena de texto es similar a traducir cualquier otra cadena:</p>

<div class="code xml">
<pre class="xml"><span class="sc3"><span class="re1">&lt;trans-unit</span> <span class="re0">id</span>=<span class="st0">&quot;6&quot;</span><span class="re2">&gt;</span></span>
  <span class="sc3"><span class="re1">&lt;source<span class="re2">&gt;</span></span></span>[0]No job in this category|[1]One job in this category|(1,+Inf]%count% jobs in this category<span class="sc3"><span class="re1">&lt;/source<span class="re2">&gt;</span></span></span>
  <span class="sc3"><span class="re1">&lt;target<span class="re2">&gt;</span></span></span>[0]Aucune annonce dans cette catégorie|[1]Une annonce dans cette catégorie|(1,+Inf]%count% annonces dans cette catégorie<span class="sc3"><span class="re1">&lt;/target<span class="re2">&gt;</span></span></span>
<span class="sc3"><span class="re1">&lt;/trans-unit<span class="re2">&gt;</span></span></span></pre>
</div>

<p>Ahora que ya sabes cómo traducir cualquier tipo de cadena de texto, dedica un tiempo a añadir llamadas al helper <code>__()</code> en todas las plantillas de la aplicación <code>frontend</code>. Por el momento no vamos a traducir la aplicación <code>backend</code>.</p>

<h3 id="formularios">19.6.2. Formularios</h3>

<p>Las clases de los formularios incluyen muchas cadenas de texto que tenemos que traducir, como etiquetas, mensajes de error y mensajes de ayuda. Symfony se encarga de internacionalizar automáticamente todas estas cadenas de texto, por lo que sólo es necesario que definas la traducción en los archivos XLIFF.</p>

<div class="admonition note"><p><strong class="title">Nota</strong> Desafortunadamente, la tarea <code>i18n:extract</code> no es capaz por el momento de procesar las clases de los formularios en busca de cadenas de texto sin traducir.</p></div>

<h3 id="objetos_propel">19.5.6. Objetos Propel</h3>

<p>En el sitio web de Jobeet no vamos a traducir el contenido de todas las tablas porque no tiene sentido que los usuarios que publican ofertas de trabajo tengan que traducir sus ofertas a todos los idiomas disponibles. No obstante, sí que vamos a traducir el contenido de la tabla <code>category</code>.</p>

<p>El plugin de Propel ya incluye el soporte de tablas internacionalizadas. Por cada tabla que vamos a traducir, tenemos que crear dos tablas: una para las columnas que son independientes de la internacionalización y otra para todas las columnas cuyos valores se van a traducir. Las dos tablas están relacionadas mediante una relación de tipo uno-a-muchos.</p>

<p>Por lo tanto, actualiza el archivo <code>schema.yml</code> para crear las dos tablas relacionadas con las categorías:</p>

<div class="code yaml">
<pre class="yaml"><span class="co1"># config/schema.yml</span><span class="co4">
jobeet_category</span>:<span class="co3">
  _attributes</span><span class="sy2">: </span> <span class="br0">&#123;</span> isI18N<span class="sy2">: </span>true, i18nTable<span class="sy2">: </span>jobeet_category_i18n <span class="br0">&#125;</span><span class="co3">
  id</span><span class="sy2">: </span>          ~
<span class="co4">
jobeet_category_i18n</span>:<span class="co3">
  id</span><span class="sy2">: </span>          <span class="br0">&#123;</span> type<span class="sy2">: </span>integer, required<span class="sy2">: </span>true, primaryKey<span class="sy2">: </span>true, foreignTable<span class="sy2">: </span>jobeet_category, foreignReference<span class="sy2">: </span>id <span class="br0">&#125;</span><span class="co3">
  culture</span><span class="sy2">: </span>     <span class="br0">&#123;</span> isCulture<span class="sy2">: </span>true, type<span class="sy2">: </span>varchar, size<span class="sy2">: </span><span class="nu0">7</span>, required<span class="sy2">: </span>true, primaryKey<span class="sy2">: </span>true <span class="br0">&#125;</span><span class="co3">
  name</span><span class="sy2">: </span>        <span class="br0">&#123;</span> type<span class="sy2">: </span>varchar<span class="br0">&#40;</span><span class="nu0">255</span><span class="br0">&#41;</span>, required<span class="sy2">: </span>true <span class="br0">&#125;</span><span class="co3">
  slug</span><span class="sy2">: </span>        <span class="br0">&#123;</span> type<span class="sy2">: </span>varchar<span class="br0">&#40;</span><span class="nu0">255</span><span class="br0">&#41;</span>, required<span class="sy2">: </span>true <span class="br0">&#125;</span></pre>
</div>

<p>La opción <code>_attributes</code> define las opciones de la tabla. Después de modificar el esquema, actualiza la parte de las categorías en los archivos de datos:</p>

<div class="code yaml">
<pre class="yaml"><span class="co1"># data/fixtures/010_categories.yml</span><span class="co4">
JobeetCategory</span>:<span class="co3">
  design</span><span class="sy2">: </span>       <span class="br0">&#123;</span> <span class="br0">&#125;</span><span class="co3">
  programming</span><span class="sy2">: </span>  <span class="br0">&#123;</span> <span class="br0">&#125;</span><span class="co3">
  manager</span><span class="sy2">: </span>      <span class="br0">&#123;</span> <span class="br0">&#125;</span><span class="co3">
  administrator</span><span class="sy2">: </span><span class="br0">&#123;</span> <span class="br0">&#125;</span>
<span class="co4">
JobeetCategoryI18n</span>:<span class="co3">
  design_en</span><span class="sy2">: </span>       <span class="br0">&#123;</span> id<span class="sy2">: </span>design, culture<span class="sy2">: </span>en, name<span class="sy2">: </span>Design <span class="br0">&#125;</span><span class="co3">
  programming_en</span><span class="sy2">: </span>  <span class="br0">&#123;</span> id<span class="sy2">: </span>programming, culture<span class="sy2">: </span>en, name<span class="sy2">: </span>Programming <span class="br0">&#125;</span><span class="co3">
  manager_en</span><span class="sy2">: </span>      <span class="br0">&#123;</span> id<span class="sy2">: </span>manager, culture<span class="sy2">: </span>en, name<span class="sy2">: </span>Manager <span class="br0">&#125;</span><span class="co3">
  administrator_en</span><span class="sy2">: </span><span class="br0">&#123;</span> id<span class="sy2">: </span>administrator, culture<span class="sy2">: </span>en, name<span class="sy2">: </span>Administrator <span class="br0">&#125;</span>
<span class="co3">
  design_fr</span><span class="sy2">: </span>       <span class="br0">&#123;</span> id<span class="sy2">: </span>design, culture<span class="sy2">: </span>fr, name<span class="sy2">: </span>Design <span class="br0">&#125;</span><span class="co3">
  programming_fr</span><span class="sy2">: </span>  <span class="br0">&#123;</span> id<span class="sy2">: </span>programming, culture<span class="sy2">: </span>fr, name<span class="sy2">: </span>Programmation <span class="br0">&#125;</span><span class="co3">
  manager_fr</span><span class="sy2">: </span>      <span class="br0">&#123;</span> id<span class="sy2">: </span>manager, culture<span class="sy2">: </span>fr, name<span class="sy2">: </span>Manager <span class="br0">&#125;</span><span class="co3">
  administrator_fr</span><span class="sy2">: </span><span class="br0">&#123;</span> id<span class="sy2">: </span>administrator, culture<span class="sy2">: </span>fr, name<span class="sy2">: </span>Administrateur <span class="br0">&#125;</span></pre>
</div>

<p>A continuación, vuelve a generar las clases del modelo para que se creen las clases relacionadas con la internacionalización:</p>

<div class="code cli">
<pre class="cli">$ php symfony propel:build-all --no-confirmation
$ php symfony cc</pre>
</div>

<p>Como las columnas <code>name</code> y <code>slug</code> se han movido a la tabla internacionalizada, mueve el método <code>setName()</code> de <code>JobeetCategory</code> a <code>JobeetCategoryI18n</code>:</p>

<div class="code php">
<pre class="php"><span class="co1">// lib/model/JobeetCategoryI18n.php</span>
<span class="kw2">public</span> <span class="kw2">function</span> setName<span class="br0">&#40;</span><span class="re0">$name</span><span class="br0">&#41;</span>
<span class="br0">&#123;</span>
  parent<span class="sy0">::</span><span class="me2">setName</span><span class="br0">&#40;</span><span class="re0">$name</span><span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp;
  <span class="re0">$this</span><span class="sy0">-&gt;</span><span class="me1">setSlug</span><span class="br0">&#40;</span>Jobeet<span class="sy0">::</span><span class="me2">slugify</span><span class="br0">&#40;</span><span class="re0">$name</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="sy0">;</span>
<span class="br0">&#125;</span></pre>
</div>

<p>También debemos arreglar el método <code>getForSlug()</code> de la clase <code>JobeetCategoryPeer</code>:</p>

<div class="code php">
<pre class="php"><span class="co1">// lib/model/JobeetCategoryPeer.php</span>
static <span class="kw2">public</span> <span class="kw2">function</span> getForSlug<span class="br0">&#40;</span><span class="re0">$slug</span><span class="br0">&#41;</span>
<span class="br0">&#123;</span>
  <span class="re0">$criteria</span> <span class="sy0">=</span> <span class="kw2">new</span> Criteria<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
  <span class="re0">$criteria</span><span class="sy0">-&gt;</span><span class="me1">addJoin</span><span class="br0">&#40;</span>JobeetCategoryI18nPeer<span class="sy0">::</span><span class="me2">ID</span><span class="sy0">,</span> <span class="kw2">self</span><span class="sy0">::</span><span class="me2">ID</span><span class="br0">&#41;</span><span class="sy0">;</span>
  <span class="re0">$criteria</span><span class="sy0">-&gt;</span><span class="me1">add</span><span class="br0">&#40;</span>JobeetCategoryI18nPeer<span class="sy0">::</span><span class="me2">CULTURE</span><span class="sy0">,</span> <span class="st_h">'en'</span><span class="br0">&#41;</span><span class="sy0">;</span>
  <span class="re0">$criteria</span><span class="sy0">-&gt;</span><span class="me1">add</span><span class="br0">&#40;</span>JobeetCategoryI18nPeer<span class="sy0">::</span><span class="me2">SLUG</span><span class="sy0">,</span> <span class="re0">$slug</span><span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp;
  <span class="kw1">return</span> <span class="kw2">self</span><span class="sy0">::</span><span class="me2">doSelectOne</span><span class="br0">&#40;</span><span class="re0">$criteria</span><span class="br0">&#41;</span><span class="sy0">;</span>
<span class="br0">&#125;</span></pre>
</div>

<div class="admonition note"><p><strong class="title">Nota</strong> Como la tarea <code>propel:build-all</code> borra todas las tablas y toda la información de la base de datos, no te olvides de volver a crear un usuario para acceder a la parte de administración de Jobeet mediante la tarea <code>guard:create-user</code>. Si lo prefieres, puedes crear un archivo de datos para añadir este usuario de forma automática.</p></div>

<p>Después de construir el modelo, verás que Symfony crea métodos en el objeto <code>JobeetCategory</code> principal para acceder a las columnas internacionalizadas definidas en la clase <code>JobeetCategoryI18n</code>:</p>

<div class="code php">
<pre class="php"><span class="re0">$category</span> <span class="sy0">=</span> <span class="kw2">new</span> JobeetCategory<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp;
<span class="re0">$category</span><span class="sy0">-&gt;</span><span class="me1">setName</span><span class="br0">&#40;</span><span class="st_h">'foo'</span><span class="br0">&#41;</span><span class="sy0">;</span>       <span class="co1">// sets the name for the current culture</span>
<span class="re0">$category</span><span class="sy0">-&gt;</span><span class="me1">setName</span><span class="br0">&#40;</span><span class="st_h">'foo'</span><span class="sy0">,</span> <span class="st_h">'fr'</span><span class="br0">&#41;</span><span class="sy0">;</span> <span class="co1">// sets the name for French</span>
&nbsp;
<span class="kw1">echo</span> <span class="re0">$category</span><span class="sy0">-&gt;</span><span class="me1">getName</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>     <span class="co1">// gets the name for the current culture</span>
<span class="kw1">echo</span> <span class="re0">$category</span><span class="sy0">-&gt;</span><span class="me1">getName</span><span class="br0">&#40;</span><span class="st_h">'fr'</span><span class="br0">&#41;</span><span class="sy0">;</span> <span class="co1">// gets the name for French</span></pre>
</div>

<div class="admonition note"><p><strong class="title">Nota</strong> Si quieres reducir el número de consultas a la base de datos, utiliza el método <code>doSelectWithI18n()</code> en vez del tradicional método <code>doSelect()</code>. Este nuevo método obtiene en una sola consulta el objeto principal y el objeto internacionalizado asociado.</p>

<div class="code php">
<pre class="php"><span class="re0">$categories</span> <span class="sy0">=</span> JobeetCategoryPeer<span class="sy0">::</span><span class="me2">doSelectWithI18n</span><span class="br0">&#40;</span><span class="re0">$c</span><span class="sy0">,</span> <span class="re0">$culture</span><span class="br0">&#41;</span><span class="sy0">;</span></pre>
</div>

<p></p></div>

<p>Como la ruta <code>category</code> está asociada a la clase <code>JobeetCategory</code> del modelo y como <code>slug</code> ahora es parte de <code>JobeetCategoryI18n</code>, la ruta no es capaz de obtener el objeto <code>Category</code> automáticamente. Vamos a crear un método para ayudar al sistema de enrutamiento a obtener el objeto:</p>

<div class="code php">
<pre class="php"><span class="co1">// lib/model/JobeetCategoryPeer.php</span>
<span class="kw2">class</span> JobeetCategoryPeer <span class="kw2">extends</span> BaseJobeetCategoryPeer
<span class="br0">&#123;</span>
  static <span class="kw2">public</span> <span class="kw2">function</span> doSelectForSlug<span class="br0">&#40;</span><span class="re0">$parameters</span><span class="br0">&#41;</span>
  <span class="br0">&#123;</span>
    <span class="re0">$criteria</span> <span class="sy0">=</span> <span class="kw2">new</span> Criteria<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
    <span class="re0">$criteria</span><span class="sy0">-&gt;</span><span class="me1">addJoin</span><span class="br0">&#40;</span>JobeetCategoryI18nPeer<span class="sy0">::</span><span class="me2">ID</span><span class="sy0">,</span> JobeetCategoryPeer<span class="sy0">::</span><span class="me2">ID</span><span class="br0">&#41;</span><span class="sy0">;</span>
    <span class="re0">$criteria</span><span class="sy0">-&gt;</span><span class="me1">add</span><span class="br0">&#40;</span>JobeetCategoryI18nPeer<span class="sy0">::</span><span class="me2">CULTURE</span><span class="sy0">,</span> <span class="re0">$parameters</span><span class="br0">&#91;</span><span class="st_h">'sf_culture'</span><span class="br0">&#93;</span><span class="br0">&#41;</span><span class="sy0">;</span>
    <span class="re0">$criteria</span><span class="sy0">-&gt;</span><span class="me1">add</span><span class="br0">&#40;</span>JobeetCategoryI18nPeer<span class="sy0">::</span><span class="me2">SLUG</span><span class="sy0">,</span> <span class="re0">$parameters</span><span class="br0">&#91;</span><span class="st_h">'slug'</span><span class="br0">&#93;</span><span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp;
    <span class="kw1">return</span> <span class="kw2">self</span><span class="sy0">::</span><span class="me2">doSelectOne</span><span class="br0">&#40;</span><span class="re0">$criteria</span><span class="br0">&#41;</span><span class="sy0">;</span>
  <span class="br0">&#125;</span>
<span class="br0">&#125;</span></pre>
</div>

<p>Después, utiliza la opción <code>method</code> en la ruta <code>category</code> para indicar que <code>doSelectForSlug()</code> es el método que se debe utilizar para obtener el objeto:</p>

<div class="code yaml">
<pre class="yaml"><span class="co1"># apps/frontend/config/routing.yml</span><span class="co4">
category</span>:<span class="co3">
  url</span><span class="sy2">: </span>    /:sf_culture/category/:slug.:sf_format<span class="co3">
  class</span><span class="sy2">: </span>  sfPropelRoute<span class="co3">
  param</span><span class="sy2">: </span>  <span class="br0">&#123;</span> module<span class="sy2">: </span>category, action<span class="sy2">: </span>show, sf_format<span class="sy2">: </span>html <span class="br0">&#125;</span><span class="co3">
  options</span><span class="sy2">: </span><span class="br0">&#123;</span> model<span class="sy2">: </span>JobeetCategory, type<span class="sy2">: </span>object, method<span class="sy2">: </span>doSelectForSlug <span class="br0">&#125;</span><span class="co4">
  requirements</span>:<span class="co3">
    sf_format</span><span class="sy2">: </span><span class="br0">&#40;</span>?:html|atom<span class="br0">&#41;</span></pre>
</div>

<p>Por último, volvemos a cargar los archivos de datos para que se generen los slugs adecuados para cada categoría:</p>

<div class="code cli">
<pre class="cli">$ php symfony propel:data-load</pre>
</div>

<p>Después de todos estos cambios, la ruta <code>category</code> ya está internacionalizada y la URL de una categoría incluye la traducción del <code>slug</code> correspondiente:</p>

<div class="code code">
<pre class="code">/frontend_dev.php/fr/category/programmation
/frontend_dev.php/en/category/programming</pre>
</div>

<h3 id="el_generador_de_la_parte_de_administracion">19.5.7. El generador de la parte de administración</h3>

<p>Debido a un error en la versión 1.2.1 de Symfony, comenta la opción <code>title</code> en la sección <code>edit</code>:</p>

<div class="code yaml">
<pre class="yaml"><span class="co1"># apps/backend/modules/category/config/generator.yml</span><span class="co4">
edit</span><span class="sy2">:
</span>  <span class="co1">#title: Editing Category &quot;%%name%%&quot; (#%%id%%)</span></pre>
</div>

<p>En la aplicación <code>backend</code>, queremos utilizar el mismo formulario para modificar las categorías tanto en inglés como en francés:</p>

<div class="figure" id="figure_19_2">
    <img src="../../img/jobeet_1_4/f1902.png" alt="Modificando las categorías en dos idiomas a la vez" />

    <p class="caption"><strong>Figura 19.2</strong> Modificando las categorías en dos idiomas a la vez</p>
</div>


<p>Utiliza el método <code>embedI18N()</code> para incluir un formulario internacionalizado:</p>

<div class="code php">
<pre class="php"><span class="co1">// lib/form/JobeetCategoryForm.class.php</span>
<span class="kw2">class</span> JobeetCategoryForm <span class="kw2">extends</span> BaseJobeetCategoryForm
<span class="br0">&#123;</span>
  <span class="kw2">public</span> <span class="kw2">function</span> configure<span class="br0">&#40;</span><span class="br0">&#41;</span>
  <span class="br0">&#123;</span>
    <span class="kw3">unset</span><span class="br0">&#40;</span><span class="re0">$this</span><span class="br0">&#91;</span><span class="st_h">'jobeet_category_affiliate_list'</span><span class="br0">&#93;</span><span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp;
    <span class="re0">$this</span><span class="sy0">-&gt;</span><span class="me1">embedI18n</span><span class="br0">&#40;</span><span class="kw3">array</span><span class="br0">&#40;</span><span class="st_h">'en'</span><span class="sy0">,</span> <span class="st_h">'fr'</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="sy0">;</span>
    <span class="re0">$this</span><span class="sy0">-&gt;</span><span class="me1">widgetSchema</span><span class="sy0">-&gt;</span><span class="me1">setLabel</span><span class="br0">&#40;</span><span class="st_h">'en'</span><span class="sy0">,</span> <span class="st_h">'English'</span><span class="br0">&#41;</span><span class="sy0">;</span>
    <span class="re0">$this</span><span class="sy0">-&gt;</span><span class="me1">widgetSchema</span><span class="sy0">-&gt;</span><span class="me1">setLabel</span><span class="br0">&#40;</span><span class="st_h">'fr'</span><span class="sy0">,</span> <span class="st_h">'French'</span><span class="br0">&#41;</span><span class="sy0">;</span>
  <span class="br0">&#125;</span>
<span class="br0">&#125;</span></pre>
</div>

<p>La interfaz del generador de la parte de administración incluye soporte para su internacionalización. Por defecto incluye las traducciones en 20 idiomas y es realmente sencillo añadir una nueva traducción o modificar una traducción existente. Copia en el directorio <code>i18n</code> de la aplicación el archivo del idioma que vas a modificar (las traducciones de la parte de administración se encuentran en <code>lib/vendor/symfony/lib/plugins/sfPropelPlugin/i18n/</code>). Como el archivo de tu aplicación se fusiona después con el de Symfony, puedes borrar todas las cadenas de texto cuya traducción no vas a modificar.</p>

<p>Como ya habrás visto, los archivos con las traducciones del administrador se llaman <code>sf_admin.fr.xml</code> en vez de <code>fr/messages.xml</code>. De hecho, el valor <code>messages</code> es el nombre del catálogo que utiliza Symfony por defecto y puedes modificarlo por cualquier otro nombre que quieras para permitir una mejor separación entre las diferentes partes de la aplicación. No obstante, si utilizas cualquier catálogo diferente al de por defecto, tienes que indicarlo explícitamente en cada llamada al helper <code>__()</code>:</p>

<div class="code php">
<pre class="php"><span class="kw2">&lt;?php</span> <span class="kw1">echo</span> __<span class="br0">&#40;</span><span class="st_h">'About Jobeet'</span><span class="sy0">,</span> <span class="kw3">array</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">,</span> <span class="st_h">'jobeet'</span><span class="br0">&#41;</span> <span class="sy1">?&gt;</span></pre>
</div>

<p>En el ejemplo anterior, Symfony busca la traducción de la cadena <em>"About Jobeet"</em> en el catálogo llamado <code>jobeet</code>.</p>

<h3 id="pruebas">19.5.8. Pruebas</h3>

<p>Para completar la migración a una aplicación internacionalizada, no te olvides de arreglar las pruebas. En primer lugar, actualiza la información de las categorías en los archivos de datos copiando en el archivo <code>test/fixtures/010_categories.yml</code> los datos utilizados en las secciones anteriores. Después, vuelve a generar las clases del modelo para el entorno <code>test</code>:</p>

<div class="code cli">
<pre class="cli">$ php symfony propel:build-all-load --no-confirmation --env=test</pre>
</div>

<p>Por último, ejecuta todas las pruebas para asegurar que no has cometido ningún error:</p>

<div class="code cli">
<pre class="cli">$ php symfony test:all</pre>
</div>

<div class="admonition note"><p><strong class="title">Nota</strong> Cuando creamos la aplicación <code>backend</code> de Jobeet, no añadimos ninguna prueba funcional. Sin embargo, siempre que creas un módulo mediante la línea de comandos de Symfony se crean unas pruebas funcionales de ejemplo. Si quieres, puedes borrar todos estos archivos de prueba.</p></div>



    <div class="navigation row">
            <a class="span4 prev" href="cambiando_de_idioma.html">&larr; Anterior <span>19.4. Cambiando de idioma</span></a>
            
            <a class="span5 next" href="localizacion.html">Siguiente &rarr; <span>19.6. Localización</span></a>
        </div>
</div>

<div class="span3 side">
<h3 class="underline"><span>Compartir</span></h3>
<ul class="share">
    <li><a class="twitter" id="share_twitter" href="#" title="Compartir este artículo en Twitter">tw</a></li>
    <li><a class="facebook" id="share_facebook" href="#" title="Compartir este artículo en Facebook">fb</a></li>
    <li><a class="google" id="share_google" href="#" title="Compartir este artículo en Google+">g+</a></li>
</ul>

<script type="text/javascript">
var title    = 'Internacionalización (El tutorial Jobeet%29';
var page_url = encodeURIComponent(window.location);
var options  = 'menubar=no,toolbar=no,resizable=yes,scrollbars=no,width=640,height=350';
var services = {
    share_twitter:  'https://twitter.com/share?text=' + title + '&lang=es&hashtags=librosweb',
    share_facebook: 'http://www.facebook.com/sharer.php?u=' + page_url + '&t=' + title,
    share_google:   'https://plus.google.com/share?url=' + page_url + '&hl=es'
};

for (var id in services) { // don't use services.keys() for compatibility reasons
    if (services.hasOwnProperty(id)) {
        document.getElementById(id).href = services[id];
        document.getElementById(id).onclick = function(a) {
            a = a || window.event;
            a = a.target || a.srcElement;
            _gaq.push(['_trackEvent', 'share', a.id.substr(6), 'El tutorial Jobeet : Internacionalización']);
            window.open(services[a.id], a.title, options);

            return false;
        };
    }
}
</script>

<h3 class="underline"><span>Indice de contenidos</span></h3>
<ul class="toc">
    <li class="level-1">
        <span>1</span> <a href="../capitulo_1.html"> Comenzando el proyecto</a>
    </li>
    <li class="level-1">
        <span>2</span> <a href="../capitulo_2.html"> El proyecto</a>
    </li>
    <li class="level-1">
        <span>3</span> <a href="../capitulo_3.html"> El modelo de datos</a>
    </li>
    <li class="level-1">
        <span>4</span> <a href="../capitulo_4.html"> El controlador y la vista</a>
    </li>
    <li class="level-1">
        <span>5</span> <a href="../capitulo_5.html"> El sistema de enrutamiento</a>
    </li>
    <li class="level-1">
        <span>6</span> <a href="../capitulo_6.html"> Profundizando en el modelo</a>
    </li>
    <li class="level-1">
        <span>7</span> <a href="../capitulo_7.html"> Trabajando con la página de cada categoría</a>
    </li>
    <li class="level-1">
        <span>8</span> <a href="../capitulo_8.html"> Pruebas unitarias</a>
    </li>
    <li class="level-1">
        <span>9</span> <a href="../capitulo_9.html"> Pruebas funcionales</a>
    </li>
    <li class="level-1">
        <span>10</span> <a href="../capitulo_10.html"> Los formularios</a>
    </li>
    <li class="level-1">
        <span>11</span> <a href="../capitulo_11.html"> Probando los formularios</a>
    </li>
    <li class="level-1">
        <span>12</span> <a href="../capitulo_12.html"> El generador de la parte de administración</a>
    </li>
    <li class="level-1">
        <span>13</span> <a href="../capitulo_13.html"> El usuario</a>
    </li>
    <li class="level-1">
        <span>14</span> <a href="../capitulo_14.html"> El día de descanso</a>
    </li>
    <li class="level-1">
        <span>15</span> <a href="../capitulo_15.html"> Canales Atom</a>
    </li>
    <li class="level-1">
        <span>16</span> <a href="../capitulo_16.html"> Servicios web</a>
    </li>
    <li class="level-1">
        <span>17</span> <a href="../capitulo_17.html"> El buscador</a>
    </li>
    <li class="level-1">
        <span>18</span> <a href="../capitulo_18.html"> AJAX</a>
    </li>
    <li class="level-1 ">
        <a href="../capitulo_19.html">
            <span>Capítulo 19.</span> Internacionalización y localización
        </a>
    </li>
    <li class="level-2 ">
        <a href="el_usuario.html">
            <span>19.1.</span> El usuario
        </a>
    </li>
    <li class="level-2 ">
        <a href="incluyendo_la_cultura_en_la_url.html">
            <span>19.2.</span> Incluyendo la cultura en la URL
        </a>
    </li>
    <li class="level-2 ">
        <a href="probando_la_cultura.html">
            <span>19.3.</span> Probando la cultura
        </a>
    </li>
    <li class="level-2 ">
        <a href="cambiando_de_idioma.html">
            <span>19.4.</span> Cambiando de idioma
        </a>
    </li>
    <li class="level-2 active">
        <a href="internacionalizacion.html">
            <span>19.5.</span> Internacionalización
        </a>
    </li>
    <li class="level-2 ">
        <a href="localizacion.html">
            <span>19.6.</span> Localización
        </a>
    </li>
    <li class="level-2 ">
        <a href="nos_vemos_manana.html">
            <span>19.7.</span> Nos vemos mañana
        </a>
    </li>
    <li class="level-1">
        <span>20</span> <a href="../capitulo_20.html"> Plugins</a>
    </li>
    <li class="level-1">
        <span>21</span> <a href="../capitulo_21.html"> El día del diseño</a>
    </li>
    <li class="level-1">
        <span>22</span> <a href="../capitulo_22.html"> La cache</a>
    </li>
    <li class="level-1">
        <span>23</span> <a href="../capitulo_23.html"> Pasando a producción</a>
    </li>
    <li class="level-1">
        <span>24</span> <a href="../capitulo_24.html"> Un repaso a Symfony</a>
    </li>
</ul>
</div>
        </div></div>
        <div id="footer" class="row">
            <span class="span6">&copy; 2013 LibrosWeb.es 
            <a href="../../contacto/index.html">Contacto</a></span>
            <span class="span6 version">2.340 días online</span>
        </div>
    </div>
    </body>
</html>

<!-- Localized -->