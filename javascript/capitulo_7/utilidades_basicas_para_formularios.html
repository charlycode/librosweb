<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="es" xml:lang="es">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta http-equiv="content-type" content="text/html; charset=utf-8" />
        <title>7.2. Utilidades básicas para formularios (Introducción a JavaScript)</title>
        <link href="../../css/main-fa23fb7.css" rel="stylesheet" type="text/css" />
        <script type="text/javascript">
            var _gaq = _gaq || [];
            _gaq.push(['_setAccount', 'UA-82842-2']);
            _gaq.push(['_trackPageview']);

            (function() {
                var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
                ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
                var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
            })();
        </script>
        <link rel="apple-touch-icon" type="image/png" href="../../apple-touch-icon.png" />
        <link rel="apple-touch-icon-precomposed" type="image/png" href="../../apple-touch-icon.png" />
        <meta name="apple-mobile-web-app-title" content="LibrosWeb" />

        <link rel="shortcut icon" type="image/png" href="../../favicon.png" />
        <meta name="site:version" content="fa23fb7" />
        <link rel="author" href="https://plus.google.com/u/0/107307901774377088868" />
        <link rel="prev" href="propiedades_basicas_de_formularios_y_elementos.html" />
        <link rel="next" href="validacion.html" />
        <link rel="start" href="../index.html" />
        <meta name="twitter:site" content="@librosweb" />
        <link rel="search" type="application/opensearchdescription+xml" href="http://librosweb.es/opensearch/documentation.xml" title="Libros y tutoriales de LibrosWeb.es" />
        <meta property="fb:page_id" content="437758756273955" />
        <meta property="fb:app_id" content="437758756273955" />
        <meta property="og:type" content="website" />
        <meta property="og:title" content="7.2. Utilidades básicas para formularios (Introducción a JavaScript)" />
        <meta property="og:image" content="http://www.gravatar.com/avatar/9f219b4dfaa677bfd0f47753c02d5126.png?s=200" />
        <meta name="msapplication-TileColor" content="#CC1414" />
        <meta name="application-name" content="LibrosWeb" />
        <meta name="msapplication-tooltip" content="Libros y tutoriales sobre HTML, CSS, JavaScript, PHP y otras tecnologías web." />
    </head>
    <body class="book_page javascript">
    <div id="container" class="container">
        <div id="header">
            <h1><a href="../../index.html" title="LibrosWeb.es">LibrosWeb</a></h1>
            <form action="/buscar"><input type="text" placeholder="buscar..." name="q"/></form>
        </div>
        <div id="content"><div class="row">
        <ul class="breadcrumbs span12">
  <li><a href="../../index.html">Inicio</a></li>
  <li><a href="../index.html">Introducción a JavaScript</a></li>
  <li><a href="../capitulo_7.html">Capítulo 7. Formularios</a></li>
  <li class="current"><span>7.2. Utilidades básicas para formularios</span></li>
</ul>

<div class="span9">
    <h1 id="utilidades_basicas_para_formularios"><span>7.2.</span> Utilidades básicas para formularios</h1>
    

<h3 id="obtener_el_valor_de_los_campos_de_formulario">7.2.1. Obtener el valor de los campos de formulario</h3>

<p>La mayoría de técnicas JavaScript relacionadas con los formularios requieren leer y/o modificar el valor de los campos del formulario. Por tanto, a continuación se muestra cómo obtener el valor de los campos de formulario más utilizados.</p>

<h4 id="cuadro_de_texto_y_textarea">7.2.1.1. Cuadro de texto y textarea</h4>

<p>El valor del texto mostrado por estos elementos se obtiene y se establece directamente mediante la propiedad <code>value</code>.</p>

<div class="code javascript">
<pre class="javascript"><span class="sy0">&lt;</span>input type<span class="sy0">=</span><span class="st0">&quot;text&quot;</span> id<span class="sy0">=</span><span class="st0">&quot;texto&quot;</span> <span class="sy0">/&gt;</span>
<span class="kw1">var</span> valor <span class="sy0">=</span> document.<span class="me1">getElementById</span><span class="br0">&#40;</span><span class="st0">&quot;texto&quot;</span><span class="br0">&#41;</span>.<span class="me1">value</span><span class="sy0">;</span>
&nbsp;
<span class="sy0">&lt;</span>textarea id<span class="sy0">=</span><span class="st0">&quot;parrafo&quot;</span><span class="sy0">&gt;&lt;/</span>textarea<span class="sy0">&gt;</span>
<span class="kw1">var</span> valor <span class="sy0">=</span> document.<span class="me1">getElementById</span><span class="br0">&#40;</span><span class="st0">&quot;parrafo&quot;</span><span class="br0">&#41;</span>.<span class="me1">value</span><span class="sy0">;</span></pre>
</div>

<h4 id="radiobutton">7.2.1.2. Radiobutton</h4>

<p>Cuando se dispone de un grupo de <em>radiobuttons</em>, generalmente no se quiere obtener el valor del atributo <code>value</code> de alguno de ellos, sino que lo importante es conocer cuál de todos los <em>radiobuttons</em> se ha seleccionado. La propiedad <code>checked</code> devuelve <code>true</code> para el <em>radiobutton</em> seleccionado y <code>false</code> en cualquier otro caso. Si por ejemplo se dispone del siguiente grupo de <em>radiobuttons</em>:</p>

<div class="code javascript">
<pre class="javascript"><span class="sy0">&lt;</span>input type<span class="sy0">=</span><span class="st0">&quot;radio&quot;</span> value<span class="sy0">=</span><span class="st0">&quot;si&quot;</span> name<span class="sy0">=</span><span class="st0">&quot;pregunta&quot;</span> id<span class="sy0">=</span><span class="st0">&quot;pregunta_si&quot;</span><span class="sy0">/&gt;</span> SI
<span class="sy0">&lt;</span>input type<span class="sy0">=</span><span class="st0">&quot;radio&quot;</span> value<span class="sy0">=</span><span class="st0">&quot;no&quot;</span> name<span class="sy0">=</span><span class="st0">&quot;pregunta&quot;</span> id<span class="sy0">=</span><span class="st0">&quot;pregunta_no&quot;</span><span class="sy0">/&gt;</span> NO
<span class="sy0">&lt;</span>input type<span class="sy0">=</span><span class="st0">&quot;radio&quot;</span> value<span class="sy0">=</span><span class="st0">&quot;nsnc&quot;</span> name<span class="sy0">=</span><span class="st0">&quot;pregunta&quot;</span> id<span class="sy0">=</span><span class="st0">&quot;pregunta_nsnc&quot;</span><span class="sy0">/&gt;</span> NS<span class="sy0">/</span>NC</pre>
</div>

<p>El siguiente código permite determinar si cada <em>radiobutton</em> ha sido seleccionado o no:</p>

<div class="code javascript">
<pre class="javascript"><span class="kw1">var</span> elementos <span class="sy0">=</span> document.<span class="me1">getElementsByName</span><span class="br0">&#40;</span><span class="st0">&quot;pregunta&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp;
<span class="kw1">for</span><span class="br0">&#40;</span><span class="kw1">var</span> i<span class="sy0">=</span><span class="nu0">0</span><span class="sy0">;</span> i<span class="sy0">&lt;</span>elementos.<span class="me1">length</span><span class="sy0">;</span> i<span class="sy0">++</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
  alert<span class="br0">&#40;</span><span class="st0">&quot; Elemento: &quot;</span> <span class="sy0">+</span> elementos<span class="br0">&#91;</span>i<span class="br0">&#93;</span>.<span class="me1">value</span> <span class="sy0">+</span> <span class="st0">&quot;<span class="es0">\n</span> Seleccionado: &quot;</span> <span class="sy0">+</span> elementos<span class="br0">&#91;</span>i<span class="br0">&#93;</span>.<span class="me1">checked</span><span class="br0">&#41;</span><span class="sy0">;</span>
<span class="br0">&#125;</span></pre>
</div>

<h4 id="checkbox">7.2.1.3. Checkbox</h4>

<p>Los elementos de tipo <em>checkbox</em> son muy similares a los <em>radiobutton</em>, salvo que en este caso se debe comprobar cada <em>checkbox</em> de forma independiente del resto. El motivo es que los grupos de <em>radiobutton</em> son mutuamente excluyentes y sólo se puede seleccionar uno de ellos cada vez. Por su parte, los <em>checkbox</em> se pueden seleccionar de forma independiente respecto de los demás.</p>

<p>Si se dispone de los siguientes <em>checkbox</em>:</p>

<div class="code javascript">
<pre class="javascript"><span class="sy0">&lt;</span>input type<span class="sy0">=</span><span class="st0">&quot;checkbox&quot;</span> value<span class="sy0">=</span><span class="st0">&quot;condiciones&quot;</span> name<span class="sy0">=</span><span class="st0">&quot;condiciones&quot;</span> id<span class="sy0">=</span><span class="st0">&quot;condiciones&quot;</span><span class="sy0">/&gt;</span> He leí<span class="kw1">do</span> y acepto las condiciones
<span class="sy0">&lt;</span>input type<span class="sy0">=</span><span class="st0">&quot;checkbox&quot;</span> value<span class="sy0">=</span><span class="st0">&quot;privacidad&quot;</span> name<span class="sy0">=</span><span class="st0">&quot;privacidad&quot;</span> id<span class="sy0">=</span><span class="st0">&quot;privacidad&quot;</span><span class="sy0">/&gt;</span> He leí<span class="kw1">do</span> la política de privacidad</pre>
</div>

<p>Utilizando la propiedad <code>checked</code>, es posible comprobar si cada <em>checkbox</em> ha sido seleccionado:</p>

<div class="code javascript">
<pre class="javascript"><span class="kw1">var</span> elemento <span class="sy0">=</span> document.<span class="me1">getElementById</span><span class="br0">&#40;</span><span class="st0">&quot;condiciones&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span>
alert<span class="br0">&#40;</span><span class="st0">&quot; Elemento: &quot;</span> <span class="sy0">+</span> elemento.<span class="me1">value</span> <span class="sy0">+</span> <span class="st0">&quot;<span class="es0">\n</span> Seleccionado: &quot;</span> <span class="sy0">+</span> elemento.<span class="me1">checked</span><span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp;
elemento <span class="sy0">=</span> document.<span class="me1">getElementById</span><span class="br0">&#40;</span><span class="st0">&quot;privacidad&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span>
alert<span class="br0">&#40;</span><span class="st0">&quot; Elemento: &quot;</span> <span class="sy0">+</span> elemento.<span class="me1">value</span> <span class="sy0">+</span> <span class="st0">&quot;<span class="es0">\n</span> Seleccionado: &quot;</span> <span class="sy0">+</span> elemento.<span class="me1">checked</span><span class="br0">&#41;</span><span class="sy0">;</span></pre>
</div>

<h4 id="select">7.2.1.4. Select</h4>

<p>Las listas desplegables (<code>&lt;select&gt;</code>) son los elementos en los que es más difícil obtener su valor. Si se dispone de una lista desplegable como la siguiente:</p>

<div class="code html">
<pre class="html5"><span class="sc2">&lt;<span class="kw2">select</span> <span class="kw3">id</span><span class="sy0">=</span><span class="st0">&quot;opciones&quot;</span> <span class="kw3">name</span><span class="sy0">=</span><span class="st0">&quot;opciones&quot;</span>&gt;</span>
  <span class="sc2">&lt;<span class="kw2">option</span> <span class="kw3">value</span><span class="sy0">=</span><span class="st0">&quot;1&quot;</span>&gt;</span>Primer valor<span class="sc2">&lt;<span class="sy0">/</span><span class="kw2">option</span>&gt;</span>
  <span class="sc2">&lt;<span class="kw2">option</span> <span class="kw3">value</span><span class="sy0">=</span><span class="st0">&quot;2&quot;</span>&gt;</span>Segundo valor<span class="sc2">&lt;<span class="sy0">/</span><span class="kw2">option</span>&gt;</span>
  <span class="sc2">&lt;<span class="kw2">option</span> <span class="kw3">value</span><span class="sy0">=</span><span class="st0">&quot;3&quot;</span>&gt;</span>Tercer valor<span class="sc2">&lt;<span class="sy0">/</span><span class="kw2">option</span>&gt;</span>
  <span class="sc2">&lt;<span class="kw2">option</span> <span class="kw3">value</span><span class="sy0">=</span><span class="st0">&quot;4&quot;</span>&gt;</span>Cuarto valor<span class="sc2">&lt;<span class="sy0">/</span><span class="kw2">option</span>&gt;</span>
<span class="sc2">&lt;<span class="sy0">/</span><span class="kw2">select</span>&gt;</span></pre>
</div>

<p>En general, lo que se requiere es obtener el valor del atributo <code>value</code> de la opción (<code>&lt;option&gt;</code>) seleccionada por el usuario. Obtener este valor no es sencillo, ya que se deben realizar una serie de pasos. Además, para obtener el valor seleccionado, deben utilizarse las siguientes propiedades:</p>

<ul>
<li><code>options</code>, es un array creado automáticamente por el navegador para cada lista desplegable y que contiene la referencia a todas las opciones de esa lista. De esta forma, la primera opción de una lista se puede obtener mediante <code>document.getElementById("id_de_la_lista").options[0]</code>.</li>
<li><code>selectedIndex</code>, cuando el usuario selecciona una opción, el navegador actualiza automáticamente el valor de esta propiedad, que guarda el índice de la opción seleccionada. El índice hace referencia al array <code>options</code> creado automáticamente por el navegador para cada lista.</li>
</ul>

<div class="code javascript">
<pre class="javascript"><span class="co1">// Obtener la referencia a la lista</span>
<span class="kw1">var</span> lista <span class="sy0">=</span> document.<span class="me1">getElementById</span><span class="br0">&#40;</span><span class="st0">&quot;opciones&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp;
<span class="co1">// Obtener el índice de la opción que se ha seleccionado</span>
<span class="kw1">var</span> indiceSeleccionado <span class="sy0">=</span> lista.<span class="me1">selectedIndex</span><span class="sy0">;</span>
<span class="co1">// Con el índice y el array &quot;options&quot;, obtener la opción seleccionada</span>
<span class="kw1">var</span> opcionSeleccionada <span class="sy0">=</span> lista.<span class="me1">options</span><span class="br0">&#91;</span>indiceSeleccionado<span class="br0">&#93;</span><span class="sy0">;</span>
&nbsp;
<span class="co1">// Obtener el valor y el texto de la opción seleccionada</span>
<span class="kw1">var</span> textoSeleccionado <span class="sy0">=</span> opcionSeleccionada.<span class="me1">text</span><span class="sy0">;</span>
<span class="kw1">var</span> valorSeleccionado <span class="sy0">=</span> opcionSeleccionada.<span class="me1">value</span><span class="sy0">;</span>
&nbsp;
alert<span class="br0">&#40;</span><span class="st0">&quot;Opción seleccionada: &quot;</span> <span class="sy0">+</span> textoSeleccionado <span class="sy0">+</span> <span class="st0">&quot;<span class="es0">\n</span> Valor de la opción: &quot;</span> <span class="sy0">+</span> valorSeleccionado<span class="br0">&#41;</span><span class="sy0">;</span></pre>
</div>

<p>Como se ha visto, para obtener el valor del atributo <code>value</code> correspondiente a la opción seleccionada por el usuario, es necesario realizar varios pasos. No obstante, normalmente se abrevian todos los pasos necesarios en una única instrucción:</p>

<div class="code javascript">
<pre class="javascript"><span class="kw1">var</span> lista <span class="sy0">=</span> document.<span class="me1">getElementById</span><span class="br0">&#40;</span><span class="st0">&quot;opciones&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp;
<span class="co1">// Obtener el valor de la opción seleccionada</span>
<span class="kw1">var</span> valorSeleccionado <span class="sy0">=</span> lista.<span class="me1">options</span><span class="br0">&#91;</span>lista.<span class="me1">selectedIndex</span><span class="br0">&#93;</span>.<span class="me1">value</span><span class="sy0">;</span>
&nbsp;
<span class="co1">// Obtener el texto que muestra la opción seleccionada</span>
<span class="kw1">var</span> valorSeleccionado <span class="sy0">=</span> lista.<span class="me1">options</span><span class="br0">&#91;</span>lista.<span class="me1">selectedIndex</span><span class="br0">&#93;</span>.<span class="me1">text</span><span class="sy0">;</span></pre>
</div>

<p>Lo más importante es no confundir el valor de la propiedad <code>selectedIndex</code> con el valor correspondiente a la propiedad <code>value</code> de la opción seleccionada. En el ejemplo anterior, la primera opción tiene un <code>value</code> igual a <code>1</code>. Sin embargo, si se selecciona esta opción, el valor de <code>selectedIndex</code> será <code>0</code>, ya que es la primera opción del array <code>options</code> (y los arrays empiezan a contar los elementos en el número <code>0</code>).</p>

<h3 id="establecer_el_foco_en_un_elemento">7.2.2. Establecer el foco en un elemento</h3>

<p>En programación, cuando un elemento está seleccionado y se puede escribir directamente en el o se puede modificar alguna de sus propiedades, se dice que tiene el foco del programa.</p>

<p>Si un cuadro de texto de un formulario tiene el foco, el usuario puede escribir directamente en el sin necesidad de pinchar previamente con el ratón en el interior del cuadro. Igualmente, si una lista desplegable tiene el foco, el usuario puede seleccionar una opción directamente subiendo y bajando con las flechas del teclado.</p>

<p>Al pulsar repetidamente la tecla <code>TABULADOR</code> sobre una página web, los diferentes elementos (enlaces, imágenes, campos de formulario, etc.) van obteniendo el foco del navegador (el elemento seleccionado cada vez suele mostrar un pequeño borde punteado).</p>

<p>Si en una página web el formulario es el elemento más importante, como por ejemplo en una página de búsqueda o en una página con un formulario para registrarse, se considera una buena práctica de usabilidad el asignar automáticamente el foco al primer elemento del formulario cuando se carga la página.</p>

<p>Para asignar el foco a un elemento de XHTML, se utiliza la función <code>focus()</code>. El siguiente ejemplo asigna el foco a un elemento de formulario cuyo atributo <code>id</code> es igual a <code>primero</code>:</p>

<div class="code javascript">
<pre class="javascript">document.<span class="me1">getElementById</span><span class="br0">&#40;</span><span class="st0">&quot;primero&quot;</span><span class="br0">&#41;</span>.<span class="me1">focus</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp;
<span class="sy0">&lt;</span>form id<span class="sy0">=</span><span class="st0">&quot;formulario&quot;</span> action<span class="sy0">=</span><span class="st0">&quot;#&quot;</span><span class="sy0">&gt;</span>
  <span class="sy0">&lt;</span>input type<span class="sy0">=</span><span class="st0">&quot;text&quot;</span> id<span class="sy0">=</span><span class="st0">&quot;primero&quot;</span> <span class="sy0">/&gt;</span>
<span class="sy0">&lt;/</span>form<span class="sy0">&gt;</span></pre>
</div>

<p>Ampliando el ejemplo anterior, se puede asignar automáticamente el foco del programa al primer elemento del primer formulario de la página, independientemente del <code>id</code> del formulario y de los elementos:</p>

<div class="code javascript">
<pre class="javascript"><span class="kw1">if</span><span class="br0">&#40;</span>document.<span class="me1">forms</span>.<span class="me1">length</span> <span class="sy0">&gt;</span> <span class="nu0">0</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
  <span class="kw1">if</span><span class="br0">&#40;</span>document.<span class="me1">forms</span><span class="br0">&#91;</span><span class="nu0">0</span><span class="br0">&#93;</span>.<span class="me1">elements</span>.<span class="me1">length</span> <span class="sy0">&gt;</span> <span class="nu0">0</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
    document.<span class="me1">forms</span><span class="br0">&#91;</span><span class="nu0">0</span><span class="br0">&#93;</span>.<span class="me1">elements</span><span class="br0">&#91;</span><span class="nu0">0</span><span class="br0">&#93;</span>.<span class="me1">focus</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
  <span class="br0">&#125;</span>
<span class="br0">&#125;</span></pre>
</div>

<p>El código anterior comprueba que existe al menos un formulario en la página mediante el tamaño del array <code>forms</code>. Si su tamaño es mayor que <code>0</code>, se utiliza este primer formulario. Empleando la misma técnica, se comprueba que el formulario tenga al menos un elemento (<code>if(document.forms[0].elements.length &gt; 0)</code>). En caso afirmativo, se establece el foco del navegador en el primer elemento del primer formulario (<code>document.forms[0].elements[0].focus();</code>).</p>

<p>Para que el ejemplo anterior sea completamente correcto, se debe añadir una comprobación adicional. El campo de formulario que se selecciona no debería ser de tipo <code>hidden</code>:</p>

<div class="code javascript">
<pre class="javascript"><span class="kw1">if</span><span class="br0">&#40;</span>document.<span class="me1">forms</span>.<span class="me1">length</span> <span class="sy0">&gt;</span> <span class="nu0">0</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
  <span class="kw1">for</span><span class="br0">&#40;</span><span class="kw1">var</span> i<span class="sy0">=</span><span class="nu0">0</span><span class="sy0">;</span> i <span class="sy0">&lt;</span> document.<span class="me1">forms</span><span class="br0">&#91;</span><span class="nu0">0</span><span class="br0">&#93;</span>.<span class="me1">elements</span>.<span class="me1">length</span><span class="sy0">;</span> i<span class="sy0">++</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
    <span class="kw1">var</span> campo <span class="sy0">=</span> document.<span class="me1">forms</span><span class="br0">&#91;</span><span class="nu0">0</span><span class="br0">&#93;</span>.<span class="me1">elements</span><span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="sy0">;</span>
    <span class="kw1">if</span><span class="br0">&#40;</span>campo.<span class="me1">type</span> <span class="sy0">!=</span> <span class="st0">&quot;hidden&quot;</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
      campo.<span class="me1">focus</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
      <span class="kw1">break</span><span class="sy0">;</span>
    <span class="br0">&#125;</span>
  <span class="br0">&#125;</span>
<span class="br0">&#125;</span></pre>
</div>

<h3 id="evitar_el_envio_duplicado_de_un_formulario">7.2.3. Evitar el envío duplicado de un formulario</h3>

<p>Uno de los problemas habituales con el uso de formularios web es la posibilidad de que el usuario pulse dos veces seguidas sobre el botón "Enviar". Si la conexión del usuario es demasiado lenta o la respuesta del servidor se hace esperar, el formulario original sigue mostrándose en el navegador y por ese motivo, el usuario tiene la tentación de volver a pinchar sobre el botón de "Enviar".</p>

<p>En la mayoría de los casos, el problema no es grave e incluso es posible controlarlo en el servidor, pero puede complicarse en formularios de aplicaciones importantes como las que implican transacciones económicas.</p>

<p>Por este motivo, una buena práctica en el diseño de aplicaciones web suele ser la de deshabilitar el botón de envío después de la primera pulsación. El siguiente ejemplo muestra el código necesario:</p>

<div class="code javascript">
<pre class="javascript"><span class="sy0">&lt;</span>form id<span class="sy0">=</span><span class="st0">&quot;formulario&quot;</span> action<span class="sy0">=</span><span class="st0">&quot;#&quot;</span><span class="sy0">&gt;</span>
  ...
  <span class="sy0">&lt;</span>input type<span class="sy0">=</span><span class="st0">&quot;button&quot;</span> value<span class="sy0">=</span><span class="st0">&quot;Enviar&quot;</span> onclick<span class="sy0">=</span><span class="st0">&quot;this.disabled=true; this.value=’Enviando...’; this.form.submit()&quot;</span> <span class="sy0">/&gt;</span>
<span class="sy0">&lt;/</span>form<span class="sy0">&gt;</span></pre>
</div>

<p>Cuando se pulsa sobre el botón de envío del formulario, se produce el evento <code>onclick</code> sobre el botón y por tanto, se ejecutan las instrucciones JavaScript contenidas en el atributo <code>onclick</code>:</p>

<ol>
<li>En primer lugar, se deshabilita el botón mediante la instrucción <code>this.disabled = true;</code>. Esta es la única instrucción necesaria si sólo se quiere deshabilitar un botón.</li>
<li>A continuación, se cambia el mensaje que muestra el botón. Del original "Enviar" se pasa al más adecuado "Enviando..."</li>
<li>Por último, se envía el formulario mediante la función <code>submit()</code> en la siguiente instrucción: <code>this.form.submit()</code></li>
</ol>

<p>El botón del ejemplo anterior está definido mediante un botón de tipo <code>&lt;input type="button" /&gt;</code>, ya que el código JavaScript mostrado no funciona correctamente con un botón de tipo <code>&lt;input type="submit" /&gt;</code>. Si se utiliza un botón de tipo <code>submit</code>, el botón se deshabilita antes de enviar el formulario y por tanto el formulario acaba sin enviarse.</p>

<h3 id="limitar_el_tamano_de_caracteres_de_un_textarea">7.2.4. Limitar el tamaño de caracteres de un textarea</h3>

<p>La carencia más importante de los campos de formulario de tipo textarea es la imposibilidad de limitar el máximo número de caracteres que se pueden introducir, de forma similar al atributo <code>maxlength</code> de los cuadros de texto normales.</p>

<p>JavaScript permite añadir esta característica de forma muy sencilla. En primer lugar, hay que recordar que con algunos eventos (como <code>onkeypress</code>, <code>onclick</code> y <code>onsubmit</code>) se puede evitar su comportamiento normal si se devuelve el valor <code>false</code>.</p>

<p>Evitar el comportamiento normal equivale a modificar completamente el comportamiento habitual del evento. Si por ejemplo se devuelve el valor <code>false</code> en el evento <code>onkeypress</code>, la tecla pulsada por el usuario no se tiene en cuenta. Si se devuelve <code>false</code> en el evento <code>onclick</code> de un elemento como un enlace, el navegador no carga la página indicada por el enlace.</p>

<p>Si un evento devuelve el valor <code>true</code>, su comportamiento es el habitual:</p>

<div class="code javascript">
<pre class="javascript"><span class="sy0">&lt;</span>textarea onkeypress<span class="sy0">=</span><span class="st0">&quot;return true;&quot;</span><span class="sy0">&gt;&lt;/</span>textarea<span class="sy0">&gt;</span></pre>
</div>

<p>En el textarea del ejemplo anterior, el usuario puede escribir cualquier carácter, ya que el evento <code>onkeypress</code> devuelve <code>true</code> y por tanto, su comportamiento es el normal y la tecla pulsada se transforma en un carácter dentro del textarea.</p>

<p>Sin embargo, en el siguiente ejemplo:</p>

<div class="code javascript">
<pre class="javascript"><span class="sy0">&lt;</span>textarea onkeypress<span class="sy0">=</span><span class="st0">&quot;return false;&quot;</span><span class="sy0">&gt;&lt;/</span>textarea<span class="sy0">&gt;</span></pre>
</div>

<p>Como el valor devuelto por el evento <code>onkeypress</code> es igual a <code>false</code>, el navegador no ejecuta el comportamiento por defecto del evento, es decir, la tecla presionada no se transforma en ningún carácter dentro del textarea. No importa las veces que se pulsen las teclas y no importa la tecla pulsada, ese textarea no permitirá escribir ningún carácter.</p>

<p>Aprovechando esta característica, es sencillo limitar el número de caracteres que se pueden escribir en un elemento de tipo textarea: se comprueba si se ha llegado al máximo número de caracteres permitido y en caso afirmativo se evita el comportamiento habitual del evento y por tanto, los caracteres adicionales no se añaden al textarea:</p>

<div class="code javascript">
<pre class="javascript"><span class="kw1">function</span> limita<span class="br0">&#40;</span>maximoCaracteres<span class="br0">&#41;</span> <span class="br0">&#123;</span>
  <span class="kw1">var</span> elemento <span class="sy0">=</span> document.<span class="me1">getElementById</span><span class="br0">&#40;</span><span class="st0">&quot;texto&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span>
  <span class="kw1">if</span><span class="br0">&#40;</span>elemento.<span class="me1">value</span>.<span class="me1">length</span> <span class="sy0">&gt;=</span> maximoCaracteres <span class="br0">&#41;</span> <span class="br0">&#123;</span>
    <span class="kw1">return</span> <span class="kw2">false</span><span class="sy0">;</span>
  <span class="br0">&#125;</span>
  <span class="kw1">else</span> <span class="br0">&#123;</span>
    <span class="kw1">return</span> <span class="kw2">true</span><span class="sy0">;</span>
  <span class="br0">&#125;</span>
<span class="br0">&#125;</span>
&nbsp;
<span class="sy0">&lt;</span>textarea id<span class="sy0">=</span><span class="st0">&quot;texto&quot;</span> onkeypress<span class="sy0">=</span><span class="st0">&quot;return limita(100);&quot;</span><span class="sy0">&gt;&lt;/</span>textarea<span class="sy0">&gt;</span></pre>
</div>

<p>En el ejemplo anterior, con cada tecla pulsada se compara el número total de caracteres del textarea con el máximo número de caracteres permitido. Si el número de caracteres es igual o mayor que el límite, se devuelve el valor <code>false</code> y por tanto, se evita el comportamiento por defecto de <code>onkeypress</code> y la tecla no se añade.</p>

<p><div class="exercise"><p class="title">Ejercicio 17</p> Mejorar el ejemplo anterior indicando en todo momento al usuario el número de caracteres que aún puede escribir. Además, se debe permitir pulsar las teclas <code>Backspace</code>, <code>Supr.</code> y las flechas horizontales cuando se haya llegado al máximo número de caracteres.</p>

<p><a href="../capitulo_11/ejercicio_17.html">Ver solución</a></div></p>

<h3 id="restringir_los_caracteres_permitidos_en_un_cuadro_de_texto">7.2.5. Restringir los caracteres permitidos en un cuadro de texto</h3>

<p>En ocasiones, puede ser útil bloquear algunos caracteres determinados en un cuadro de texto. Si por ejemplo un cuadro de texto espera que se introduzca un número, puede ser interesante no permitir al usuario introducir ningún carácter que no sea numérico.</p>

<p>Igualmente, en algunos casos puede ser útil impedir que el usuario introduzca números en un cuadro de texto. Utilizando el evento <code>onkeypress</code> y unas cuantas sentencias JavaScript, el problema se resuelve fácilmente:</p>

<div class="code javascript">
<pre class="javascript"><span class="kw1">function</span> permite<span class="br0">&#40;</span>elEvento<span class="sy0">,</span> permitidos<span class="br0">&#41;</span> <span class="br0">&#123;</span>
  <span class="co1">// Variables que definen los caracteres permitidos</span>
  <span class="kw1">var</span> numeros <span class="sy0">=</span> <span class="st0">&quot;0123456789&quot;</span><span class="sy0">;</span>
  <span class="kw1">var</span> caracteres <span class="sy0">=</span> <span class="st0">&quot; abcdefghijklmnñopqrstuvwxyzABCDEFGHIJKLMNÑOPQRSTUVWXYZ&quot;</span><span class="sy0">;</span>
  <span class="kw1">var</span> numeros_caracteres <span class="sy0">=</span> numeros <span class="sy0">+</span> caracteres<span class="sy0">;</span>
  <span class="kw1">var</span> teclas_especiales <span class="sy0">=</span> <span class="br0">&#91;</span><span class="nu0">8</span><span class="sy0">,</span> <span class="nu0">37</span><span class="sy0">,</span> <span class="nu0">39</span><span class="sy0">,</span> <span class="nu0">46</span><span class="br0">&#93;</span><span class="sy0">;</span>
  <span class="co1">// 8 = BackSpace, 46 = Supr, 37 = flecha izquierda, 39 = flecha derecha</span>
&nbsp;
&nbsp;
  <span class="co1">// Seleccionar los caracteres a partir del parámetro de la función</span>
  <span class="kw1">switch</span><span class="br0">&#40;</span>permitidos<span class="br0">&#41;</span> <span class="br0">&#123;</span>
    <span class="kw1">case</span> <span class="st0">'num'</span><span class="sy0">:</span>
      permitidos <span class="sy0">=</span> numeros<span class="sy0">;</span>
      <span class="kw1">break</span><span class="sy0">;</span>
    <span class="kw1">case</span> <span class="st0">'car'</span><span class="sy0">:</span>
      permitidos <span class="sy0">=</span> caracteres<span class="sy0">;</span>
      <span class="kw1">break</span><span class="sy0">;</span>
    <span class="kw1">case</span> <span class="st0">'num_car'</span><span class="sy0">:</span>
      permitidos <span class="sy0">=</span> numeros_caracteres<span class="sy0">;</span>
      <span class="kw1">break</span><span class="sy0">;</span>
  <span class="br0">&#125;</span>
&nbsp;
  <span class="co1">// Obtener la tecla pulsada </span>
  <span class="kw1">var</span> evento <span class="sy0">=</span> elEvento <span class="sy0">||</span> window.<span class="me1">event</span><span class="sy0">;</span>
  <span class="kw1">var</span> codigoCaracter <span class="sy0">=</span> evento.<span class="me1">charCode</span> <span class="sy0">||</span> evento.<span class="me1">keyCode</span><span class="sy0">;</span>
  <span class="kw1">var</span> caracter <span class="sy0">=</span> <span class="kw4">String</span>.<span class="me1">fromCharCode</span><span class="br0">&#40;</span>codigoCaracter<span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp;
  <span class="co1">// Comprobar si la tecla pulsada es alguna de las teclas especiales</span>
  <span class="co1">// (teclas de borrado y flechas horizontales)</span>
  <span class="kw1">var</span> tecla_especial <span class="sy0">=</span> <span class="kw2">false</span><span class="sy0">;</span>
  <span class="kw1">for</span><span class="br0">&#40;</span><span class="kw1">var</span> i <span class="kw1">in</span> teclas_especiales<span class="br0">&#41;</span> <span class="br0">&#123;</span>
    <span class="kw1">if</span><span class="br0">&#40;</span>codigoCaracter <span class="sy0">==</span> teclas_especiales<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
      tecla_especial <span class="sy0">=</span> <span class="kw2">true</span><span class="sy0">;</span>
      <span class="kw1">break</span><span class="sy0">;</span>
    <span class="br0">&#125;</span>
  <span class="br0">&#125;</span>
&nbsp;
  <span class="co1">// Comprobar si la tecla pulsada se encuentra en los caracteres permitidos</span>
  <span class="co1">// o si es una tecla especial</span>
  <span class="kw1">return</span> permitidos.<span class="me1">indexOf</span><span class="br0">&#40;</span>caracter<span class="br0">&#41;</span> <span class="sy0">!=</span> <span class="sy0">-</span><span class="nu0">1</span> <span class="sy0">||</span> tecla_especial<span class="sy0">;</span>
<span class="br0">&#125;</span>
&nbsp;
<span class="co1">// Sólo números</span>
<span class="sy0">&lt;</span>input type<span class="sy0">=</span><span class="st0">&quot;text&quot;</span> id<span class="sy0">=</span><span class="st0">&quot;texto&quot;</span> onkeypress<span class="sy0">=</span><span class="st0">&quot;return permite(event, 'num')&quot;</span> <span class="sy0">/&gt;</span>
&nbsp;
<span class="co1">// Sólo letras</span>
<span class="sy0">&lt;</span>input type<span class="sy0">=</span><span class="st0">&quot;text&quot;</span> id<span class="sy0">=</span><span class="st0">&quot;texto&quot;</span> onkeypress<span class="sy0">=</span><span class="st0">&quot;return permite(event, 'car')&quot;</span> <span class="sy0">/&gt;</span>
&nbsp;
<span class="co1">// Sólo letras o números</span>
<span class="sy0">&lt;</span>input type<span class="sy0">=</span><span class="st0">&quot;text&quot;</span> id<span class="sy0">=</span><span class="st0">&quot;texto&quot;</span> onkeypress<span class="sy0">=</span><span class="st0">&quot;return permite(event, 'num_car')&quot;</span> <span class="sy0">/&gt;</span></pre>
</div>

<p>El funcionamiento del script anterior se basa en permitir o impedir el comportamiento habitual del evento <code>onkeypress</code>. Cuando se pulsa una tecla, se comprueba si el carácter de esa tecla se encuentra dentro de los caracteres permitidos para ese elemento <code>&lt;input&gt;</code>.</p>

<p>Si el carácter se encuentra dentro de los caracteres permitidos, se devuelve <code>true</code> y por tanto el comportamiento de <code>onkeypress</code> es el habitual y la tecla se escribe. Si el carácter no se encuentra dentro de los caracteres permitidos, se devuelve <code>false</code> y por tanto se impide el comportamiento normal de <code>onkeypress</code> y la tecla no llega a escribirse en el input.</p>

<p>Además, el script anterior siempre permite la pulsación de algunas teclas <em>especiales</em>. En concreto, las teclas <code>BackSpace</code> y <code>Supr</code> para borrar caracteres y las teclas <code>Flecha Izquierda</code> y <code>Flecha Derecha</code> para moverse en el cuadro de texto siempre se pueden pulsar independientemente del tipo de caracteres permitidos.</p>



    <div class="navigation row">
            <a class="span4 prev" href="propiedades_basicas_de_formularios_y_elementos.html">&larr; Anterior <span>7.1. Propiedades básicas de formularios y elementos</span></a>
            
            <a class="span5 next" href="validacion.html">Siguiente &rarr; <span>7.3. Validación</span></a>
        </div>
</div>

<div class="span3 side">
<h3 class="underline"><span>Compartir</span></h3>
<ul class="share">
    <li><a class="twitter" id="share_twitter" href="#" title="Compartir este artículo en Twitter">tw</a></li>
    <li><a class="facebook" id="share_facebook" href="#" title="Compartir este artículo en Facebook">fb</a></li>
    <li><a class="google" id="share_google" href="#" title="Compartir este artículo en Google+">g+</a></li>
</ul>

<script type="text/javascript">
var title    = 'Utilidades básicas para formularios (Introducción a JavaScript%29';
var page_url = encodeURIComponent(window.location);
var options  = 'menubar=no,toolbar=no,resizable=yes,scrollbars=no,width=640,height=350';
var services = {
    share_twitter:  'https://twitter.com/share?text=' + title + '&lang=es&hashtags=librosweb',
    share_facebook: 'http://www.facebook.com/sharer.php?u=' + page_url + '&t=' + title,
    share_google:   'https://plus.google.com/share?url=' + page_url + '&hl=es'
};

for (var id in services) { // don't use services.keys() for compatibility reasons
    if (services.hasOwnProperty(id)) {
        document.getElementById(id).href = services[id];
        document.getElementById(id).onclick = function(a) {
            a = a || window.event;
            a = a.target || a.srcElement;
            _gaq.push(['_trackEvent', 'share', a.id.substr(6), 'Introducción a JavaScript : Utilidades básicas para formularios']);
            window.open(services[a.id], a.title, options);

            return false;
        };
    }
}
</script>

<h3 class="underline"><span>Indice de contenidos</span></h3>
<ul class="toc">
    <li class="level-1">
        <span>1</span> <a href="../capitulo_1.html"> Introducción</a>
    </li>
    <li class="level-1">
        <span>2</span> <a href="../capitulo_2.html"> El primer script</a>
    </li>
    <li class="level-1">
        <span>3</span> <a href="../capitulo_3.html"> Programación básica</a>
    </li>
    <li class="level-1">
        <span>4</span> <a href="../capitulo_4.html"> Programación avanzada</a>
    </li>
    <li class="level-1">
        <span>5</span> <a href="../capitulo_5.html"> DOM</a>
    </li>
    <li class="level-1">
        <span>6</span> <a href="../capitulo_6.html"> Eventos</a>
    </li>
    <li class="level-1 ">
        <a href="../capitulo_7.html">
            <span>Capítulo 7.</span> Formularios
        </a>
    </li>
    <li class="level-2 ">
        <a href="propiedades_basicas_de_formularios_y_elementos.html">
            <span>7.1.</span> Propiedades básicas de formularios y elementos
        </a>
    </li>
    <li class="level-2 active">
        <a href="utilidades_basicas_para_formularios.html">
            <span>7.2.</span> Utilidades básicas para formularios
        </a>
    </li>
    <li class="level-2 ">
        <a href="validacion.html">
            <span>7.3.</span> Validación
        </a>
    </li>
    <li class="level-1">
        <span>8</span> <a href="../capitulo_8.html"> Otras utilidades</a>
    </li>
    <li class="level-1">
        <span>9</span> <a href="../capitulo_9.html"> Detección y corrección de errores</a>
    </li>
    <li class="level-1">
        <span>10</span> <a href="../capitulo_10.html"> Recursos útiles</a>
    </li>
    <li class="level-1">
        <span>11</span> <a href="../capitulo_11.html"> Ejercicios resueltos</a>
    </li>
</ul>
</div>
        </div></div>
        <div id="footer" class="row">
            <span class="span6">&copy; 2013 LibrosWeb.es 
            <a href="../../contacto/index.html">Contacto</a></span>
            <span class="span6 version">2.340 días online</span>
        </div>
    </div>
    </body>
</html>

<!-- Localized -->